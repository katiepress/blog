<!DOCTYPE html>
<html lang="en-us">
  <head>
    
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="generator" content="Hugo 0.87.0 with theme Tranquilpeak 0.4.8-BETA">
<meta name="author" content="Katie Press">
<meta name="keywords" content="">
<meta name="description" content="">


<meta property="og:description" content="">
<meta property="og:type" content="article">
<meta property="og:title" content="I Want to Believe">
<meta name="twitter:title" content="I Want to Believe">
<meta property="og:url" content="https://kpress.dev/blog/2020-11-01-i-want-to-believe/">
<meta property="twitter:url" content="https://kpress.dev/blog/2020-11-01-i-want-to-believe/">
<meta property="og:site_name" content="Blog Home">
<meta property="og:description" content="">
<meta name="twitter:description" content="">
<meta property="og:locale" content="en-us">

  
    <meta property="article:published_time" content="2020-11-01T00:00:00">
  
  
    <meta property="article:modified_time" content="2020-11-01T00:00:00">
  
  
  
    
      <meta property="article:section" content="Projects">
    
  
  
    
      <meta property="article:tag" content="Web Scraping">
    
      <meta property="article:tag" content="X-Files">
    
      <meta property="article:tag" content="Datasets">
    
  


<meta name="twitter:card" content="summary">

  <meta name="twitter:site" content="@katie_press">


  <meta name="twitter:creator" content="@katie_press">






  <meta property="og:image" content="https://lh3.googleusercontent.com/FtONKA0DvR6lWjwdYbZAYLaaQ7voE_vZOCEaXjWnK6KJ6bK7bG61ASykPNXgbatEUJ_lTq5a2d0Lcm4iI4XAfCx5bjbjBtfWAAfKttTzfwkyv7xqAWOt9Sz57FMNrizpUGeeY2jIlHeiHsmTmXKS2h_oLOJoeq-msxUO7NjF4Jf3ZNu9O_E4RjHDUCl_emRlAXg9IdpSTDZg4iCmACtohbjW6khII4fdiUEUImhP7CTRGrTNL3MB8L3P2wKO1vnM30DCmmE-ogrYDNKmtro8ZssBpaLMDK8fXsRvQEZT5xrXvQLQTuK6SLcLGk0K9nT24VQ8kpCwBCHDhLhJXHuHlj7fnh2Wqu8WmIjWMpF3Jt4UAlXWx4-ab1rbWhdkIpNv7ovM9yWsRhACaohYEbNiEZqF5iuDCTAaVTvqADsoRLrKx-LaCvhH2Zz67xA4dMge2TTa-IyovkgMkK-gSsstDQvY3T_yQEdyBFuBWuoIywPjo7rlPWNvw6I2xoJG5qR6TrhtQWWrW4UtV9M8VQ6LbysmBHjMKsvyqw-CepBwcrrBanxcjRKUQicgYTILFvvI8FkNSDMdCBZnRArgbwSWHJkbltetldeEbGR_K8M26MuRB4oMr4ykFxzPxbiTvgF1oIEBgUJOxiqzqiIP_eoBhsnjVrvdP5vI3dOgiF9hM8SYIol5obRUEzg44NcOghBNq6Krlkfk9EoGNd5vLnrPudk=w750-h250-no?authuser=0">
  <meta property="twitter:image" content="https://lh3.googleusercontent.com/FtONKA0DvR6lWjwdYbZAYLaaQ7voE_vZOCEaXjWnK6KJ6bK7bG61ASykPNXgbatEUJ_lTq5a2d0Lcm4iI4XAfCx5bjbjBtfWAAfKttTzfwkyv7xqAWOt9Sz57FMNrizpUGeeY2jIlHeiHsmTmXKS2h_oLOJoeq-msxUO7NjF4Jf3ZNu9O_E4RjHDUCl_emRlAXg9IdpSTDZg4iCmACtohbjW6khII4fdiUEUImhP7CTRGrTNL3MB8L3P2wKO1vnM30DCmmE-ogrYDNKmtro8ZssBpaLMDK8fXsRvQEZT5xrXvQLQTuK6SLcLGk0K9nT24VQ8kpCwBCHDhLhJXHuHlj7fnh2Wqu8WmIjWMpF3Jt4UAlXWx4-ab1rbWhdkIpNv7ovM9yWsRhACaohYEbNiEZqF5iuDCTAaVTvqADsoRLrKx-LaCvhH2Zz67xA4dMge2TTa-IyovkgMkK-gSsstDQvY3T_yQEdyBFuBWuoIywPjo7rlPWNvw6I2xoJG5qR6TrhtQWWrW4UtV9M8VQ6LbysmBHjMKsvyqw-CepBwcrrBanxcjRKUQicgYTILFvvI8FkNSDMdCBZnRArgbwSWHJkbltetldeEbGR_K8M26MuRB4oMr4ykFxzPxbiTvgF1oIEBgUJOxiqzqiIP_eoBhsnjVrvdP5vI3dOgiF9hM8SYIol5obRUEzg44NcOghBNq6Krlkfk9EoGNd5vLnrPudk=w750-h250-no?authuser=0">


  <meta property="og:image" content="https://lh3.googleusercontent.com/mFWs4Xy5IJZwePMcLIKtLRfNildIU_shmZlkNMbI6Qbb7ty05NaJSsk9gDkqAZW74-lxNAGc3VUU68k1UHGZK-pMs0e7k-vf2zIOTWaU6agpnGJTPpwGFxbw4F_Chl9mfi5sVUWPtrvsOrKZ3ZMqeZDyKnZp1StR7lUrun82F8_ojKxLLlOETJYH3IiMH711-73MkFJiigWUp1Kyh17oqa5gwjhHdpyOU395BBrz_czpQcxwxbtZZU2EkTK1n1mZpIStL1OH9laKha2cidCtJQCbksltON-NONbBu5pqtIXyxhbtNBEDTEj6i_MUu4MnQCk2gT8bmiGonHoeGvlIcMIviVvPlRlfd61sijHl5TGAJcYlPZqPmrAOgjWaFs6duXe5299spBPRmFd203DCtYU6jjPj3CwphmJsbSoJcH0KhZK4s9gzgtflehun0uAjrQemkuxh_44lovfp5dqmyyGT9xCTGof2sElmtqD7kQQJjIgQAtTdZBB9wQKBdA7rapjdohEOwBXp2uqmGezIpMkGO39gebOScoeYlbJJ1QtYnE7vrc7BQeVmWyPoz4VUTXcSLG32oOOocf-G9DzxxZbpsspWMtNygOysgIpfEMZAFrrb5Yzg6wcQOiqaJfZisATSEH2G1H7wVMYnarSEVTv3Sxw6mSRpUqHNzYskt4F-Fz9orSv34ZKMPM03s-wRB-NTGEBm4FvBpYVSpr8V-8s=w1106-h1168-no?authuser=0">
  <meta property="twitter:image" content="https://lh3.googleusercontent.com/mFWs4Xy5IJZwePMcLIKtLRfNildIU_shmZlkNMbI6Qbb7ty05NaJSsk9gDkqAZW74-lxNAGc3VUU68k1UHGZK-pMs0e7k-vf2zIOTWaU6agpnGJTPpwGFxbw4F_Chl9mfi5sVUWPtrvsOrKZ3ZMqeZDyKnZp1StR7lUrun82F8_ojKxLLlOETJYH3IiMH711-73MkFJiigWUp1Kyh17oqa5gwjhHdpyOU395BBrz_czpQcxwxbtZZU2EkTK1n1mZpIStL1OH9laKha2cidCtJQCbksltON-NONbBu5pqtIXyxhbtNBEDTEj6i_MUu4MnQCk2gT8bmiGonHoeGvlIcMIviVvPlRlfd61sijHl5TGAJcYlPZqPmrAOgjWaFs6duXe5299spBPRmFd203DCtYU6jjPj3CwphmJsbSoJcH0KhZK4s9gzgtflehun0uAjrQemkuxh_44lovfp5dqmyyGT9xCTGof2sElmtqD7kQQJjIgQAtTdZBB9wQKBdA7rapjdohEOwBXp2uqmGezIpMkGO39gebOScoeYlbJJ1QtYnE7vrc7BQeVmWyPoz4VUTXcSLG32oOOocf-G9DzxxZbpsspWMtNygOysgIpfEMZAFrrb5Yzg6wcQOiqaJfZisATSEH2G1H7wVMYnarSEVTv3Sxw6mSRpUqHNzYskt4F-Fz9orSv34ZKMPM03s-wRB-NTGEBm4FvBpYVSpr8V-8s=w1106-h1168-no?authuser=0">




  <meta property="og:image" content="https://kpress.dev/img/tuxedo.jpg">
  <meta property="twitter:image" content="https://kpress.dev/img/tuxedo.jpg">


    <title>I Want to Believe</title>

    <link rel="icon" href="https://kpress.dev/favicon.png">
    

    

    <link rel="canonical" href="https://kpress.dev/blog/2020-11-01-i-want-to-believe/">

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/jquery.fancybox.min.css" integrity="sha256-vuXZ9LGmmwtjqFX1F+EKin1ThZMub58gKULUyf0qECk=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/helpers/jquery.fancybox-thumbs.min.css" integrity="sha256-SEa4XYAHihTcEP1f5gARTB2K26Uk8PsndQYHQC1f4jU=" crossorigin="anonymous" />
    
    
    <link rel="stylesheet" href="https://kpress.dev/css/style-twzjdbqhmnnacqs0pwwdzcdbt8yhv8giawvjqjmyfoqnvazl0dalmnhdkvp7.min.css" />
    
    
      
        <link rel="stylesheet" href="https://kpress.dev/static/css/custom.scss">
      
    

    
      
    
    
  </head>

  <body>
    <div id="blog">
      <header id="header" data-behavior="5">
  <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
  <div class="header-title">
    <a class="header-title-link" href="https://kpress.dev/">Blog Home</a>
  </div>
  
    
      <a class="header-right-picture "
         href="https://kpress.dev/#about">
    
    
    
      
        <img class="header-picture" src="https://kpress.dev/img/tuxedo.jpg" alt="Author&#39;s picture" />
      
    
    </a>
  
</header>

      <nav id="sidebar" data-behavior="5">
  <div class="sidebar-container">
    
      <div class="sidebar-profile">
        <a href="https://kpress.dev/#about">
          <img class="sidebar-profile-picture" src="https://kpress.dev/img/tuxedo.jpg" alt="Author&#39;s picture" />
        </a>
        <h4 class="sidebar-profile-name">Katie Press</h4>
        
          <h5 class="sidebar-profile-bio">R Programmer, Data Enthusiast</h5>
        
      </div>
    
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://kpress.dev/">
    
      <i class="sidebar-button-icon fa fa-lg fa-code"></i>
      
      <span class="sidebar-button-desc">Blog</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://kpress.dev/categories">
    
      <i class="sidebar-button-icon fa fa-lg fa-sitemap"></i>
      
      <span class="sidebar-button-desc">Categories</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://kpress.dev/tags">
    
      <i class="sidebar-button-icon fa fa-lg fa-hashtag"></i>
      
      <span class="sidebar-button-desc">Tags</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://kpress.dev/archives">
    
      <i class="sidebar-button-icon fa fa-lg fa-floppy-o"></i>
      
      <span class="sidebar-button-desc">Archives</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://github.com/katiepress" target="_blank" rel="noopener">
    
      <i class="sidebar-button-icon fa fa-lg fa-github"></i>
      
      <span class="sidebar-button-desc">GitHub</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      

    </ul>
  </div>
</nav>

      
  <div class="post-header-cover
              text-center
              "
       style="background-image:url('https://lh3.googleusercontent.com/mFWs4Xy5IJZwePMcLIKtLRfNildIU_shmZlkNMbI6Qbb7ty05NaJSsk9gDkqAZW74-lxNAGc3VUU68k1UHGZK-pMs0e7k-vf2zIOTWaU6agpnGJTPpwGFxbw4F_Chl9mfi5sVUWPtrvsOrKZ3ZMqeZDyKnZp1StR7lUrun82F8_ojKxLLlOETJYH3IiMH711-73MkFJiigWUp1Kyh17oqa5gwjhHdpyOU395BBrz_czpQcxwxbtZZU2EkTK1n1mZpIStL1OH9laKha2cidCtJQCbksltON-NONbBu5pqtIXyxhbtNBEDTEj6i_MUu4MnQCk2gT8bmiGonHoeGvlIcMIviVvPlRlfd61sijHl5TGAJcYlPZqPmrAOgjWaFs6duXe5299spBPRmFd203DCtYU6jjPj3CwphmJsbSoJcH0KhZK4s9gzgtflehun0uAjrQemkuxh_44lovfp5dqmyyGT9xCTGof2sElmtqD7kQQJjIgQAtTdZBB9wQKBdA7rapjdohEOwBXp2uqmGezIpMkGO39gebOScoeYlbJJ1QtYnE7vrc7BQeVmWyPoz4VUTXcSLG32oOOocf-G9DzxxZbpsspWMtNygOysgIpfEMZAFrrb5Yzg6wcQOiqaJfZisATSEH2G1H7wVMYnarSEVTv3Sxw6mSRpUqHNzYskt4F-Fz9orSv34ZKMPM03s-wRB-NTGEBm4FvBpYVSpr8V-8s=w1106-h1168-no?authuser=0')"
       data-behavior="5">
    
      <div class="post-header main-content-wrap text-center">
  
    <h1 class="post-title" itemprop="headline">
      I Want to Believe
    </h1>
  
  
  <div class="postShorten-meta post-meta">
    
      <time itemprop="datePublished" datetime="2020-11-01T00:00:00Z">
        
  November 1, 2020

      </time>
    
    
  
  
    <span>in</span>
    
      <a class="category-link" href="https://kpress.dev/categories/projects">Projects</a>
    
  

  </div>

</div>
    
  </div>


      <div id="main" data-behavior="5"
        class="hasCover
               hasCoverMetaIn
               ">
        <article class="post" itemscope itemType="http://schema.org/BlogPosting">
          
          
          <div class="post-content markdown" itemprop="articleBody">
            <div class="main-content-wrap">
              <h1 id="web-scraping-x-files-scripts">Web Scraping X-Files Scripts</h1>
<p>In the last &ldquo;episode&rdquo; I created a dataset of X-Files episodes using web scraping. The simple episode descriptions are not going to give me the depth of information I need for a real text analysis, so it&rsquo;s time to get some more data!</p>
<p>Many of the X-Files episode transcripts are available online, so I found a website I could use to scrape most of the text I need. First, I&rsquo;m going to create a list of episode links that I can use to download the transcripts. There are 202 transcripts, so I can simply repeat the link 202 times and add the .txt at the end.</p>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">links <span style="color:#ff6ac1">&lt;-</span> <span style="color:#57c7ff">rep</span>(<span style="color:#57c7ff">paste0</span>(<span style="color:#5af78e">&#34;http://scifi.media/wp-content/uploads/t/x/&#34;</span>, <span style="color:#ff9f43">1</span><span style="color:#ff6ac1">:</span><span style="color:#ff9f43">202</span>, <span style="color:#5af78e">&#34;.txt&#34;</span>))
</code></pre></div><p>Now I want to use read_csv to read each link as a new CSV in a list. However, the first time I tried to do this, episode 185 did not import correctly. Upon further investigation, I determined that this was due to a special character in the epiosde name &ldquo;DÃ†MONICUS&rdquo;. Basically, this is an encoding issue. I just tested out a couple different encoding types and pretty easily found one that worked. Note: I tested them on a subset of just episode 184 and 185 to save time, since it can take a while to read in all of the data.</p>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#78787e">#test &lt;- links[184:185]</span>

episodes <span style="color:#ff6ac1">&lt;-</span> <span style="color:#57c7ff">lapply</span>(links, <span style="color:#57c7ff">function</span>(x) <span style="color:#57c7ff">read_csv</span>(x, locale <span style="color:#ff6ac1">=</span> <span style="color:#57c7ff">locale</span>(encoding <span style="color:#ff6ac1">=</span> <span style="color:#5af78e">&#34;ISO-8859-1&#34;</span>)))
</code></pre></div><p>Now get the data into tidy format. This might not be the absolute best way of doing it, but it&rsquo;s pretty easy and quick. First use map_df from purrr to bind all the list elements together in a dataframe. That gives me a very messy dataframe with one column for each episode.</p>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">episodes <span style="color:#ff6ac1">&lt;-</span> episodes <span style="color:#ff6ac1">%&gt;%</span> 
  <span style="color:#57c7ff">map_df</span>(bind_cols, .id <span style="color:#ff6ac1">=</span> <span style="color:#5af78e">&#34;source&#34;</span>)
</code></pre></div><p>So I can just use gather to put them in the proper (long) format that I want, and filter out the NAs resulting from the different columns.</p>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">episodes <span style="color:#ff6ac1">&lt;-</span> episodes <span style="color:#ff6ac1">%&gt;%</span> 
  <span style="color:#57c7ff">gather</span>(title, text, <span style="color:#ff6ac1">-</span>source) <span style="color:#ff6ac1">%&gt;%</span> 
  <span style="color:#57c7ff">filter</span>(<span style="color:#ff6ac1">!</span><span style="color:#57c7ff">is.na</span>(text))
</code></pre></div><p>Now I want to do some more text manipulation and cleaning. First I&rsquo;ll look for speakers, which is usually a capitalized name followed by a colon. Then put the spoken text in a separate column. Note that there will be exceptions, text analysis is not an exact science and you can drive yourself crazy trying to fix small issues.</p>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">episodes <span style="color:#ff6ac1">&lt;-</span> episodes <span style="color:#ff6ac1">%&gt;%</span> 
  <span style="color:#57c7ff">mutate</span>(speaker <span style="color:#ff6ac1">=</span> <span style="color:#57c7ff">word</span>(text, <span style="color:#ff9f43">1</span>, sep <span style="color:#ff6ac1">=</span> <span style="color:#5af78e">&#34;:&#34;</span>)) <span style="color:#ff6ac1">%&gt;%</span> 
  <span style="color:#57c7ff">mutate</span>(speaker <span style="color:#ff6ac1">=</span> <span style="color:#57c7ff">ifelse</span>(speaker <span style="color:#ff6ac1">==</span> text, <span style="color:#ff6ac1">NA</span>, speaker)) <span style="color:#ff6ac1">%&gt;%</span> 
  <span style="color:#57c7ff">mutate</span>(line <span style="color:#ff6ac1">=</span> <span style="color:#57c7ff">word</span>(text, <span style="color:#ff9f43">2</span>, sep <span style="color:#ff6ac1">=</span> <span style="color:#5af78e">&#34;:&#34;</span>))
</code></pre></div><p>Now I&rsquo;m basically going to filter out anything I&rsquo;ve already determined is a scene description or other descriptive filler.</p>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">ep_text <span style="color:#ff6ac1">&lt;-</span> episodes <span style="color:#ff6ac1">%&gt;%</span> 
  <span style="color:#57c7ff">filter</span>(<span style="color:#ff6ac1">!</span><span style="color:#57c7ff">is.na</span>(speaker))
</code></pre></div><p>I&rsquo;ll check to see how many lines each speaker has. This is also a good way to filter out descriptive text that wasn&rsquo;t already filtered out in the previous step.</p>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">temp <span style="color:#ff6ac1">&lt;-</span> <span style="color:#57c7ff">count</span>(ep_text, speaker) <span style="color:#ff6ac1">%&gt;%</span> <span style="color:#57c7ff">arrange</span>(<span style="color:#57c7ff">desc</span>(n))

</code></pre></div><p>For example, I see that &ldquo;CUT TO&rdquo; has 297 lines and &ldquo;( CUT TO&rdquo; has 126 lines, so I obviously want to get rid of it because that&rsquo;s not a real speaker. This is where X-Files knowledge comes in handy, because I already know that &ldquo;X&rdquo; and DEEP THROAT&quot; are actual speakers. I&rsquo;m also going to get rid of speakers that are just numbers (formatting issue, probably times). I can&rsquo;t just exclude all of the speakers that include numbers, because there are some that are legitimate. For example, &ldquo;Man 1&rdquo;, and there is an entire episode that takes place in the past (in addition to other flashbacks), so you have things like &ldquo;1939 Scully&rdquo;. It&rsquo;s a great episode so I definitely don&rsquo;t want to miss that! For that reason I&rsquo;ll also just keep a character vector of speakers to exclude in addition to the str_detect. Getting rid of anything with a bracket is also partciularly useful. Finally, I will filter out any speaker with only one line, because this will get rid of a lot of noise as well.</p>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">temp <span style="color:#ff6ac1">&lt;-</span> temp <span style="color:#ff6ac1">%&gt;%</span> <span style="color:#57c7ff">filter</span>(n <span style="color:#ff6ac1">==</span> <span style="color:#ff9f43">1</span>)

ep_text <span style="color:#ff6ac1">&lt;-</span> ep_text <span style="color:#ff6ac1">%&gt;%</span> 
  <span style="color:#57c7ff">filter</span>(<span style="color:#ff6ac1">!</span><span style="color:#57c7ff">str_detect</span>(speaker, <span style="color:#5af78e">&#34;CUT|From|from|The|the|\\[|\\(|\\?&#34;</span>), 
         <span style="color:#ff6ac1">!</span>speaker <span style="color:#ff6ac1">%in%</span> <span style="color:#57c7ff">c</span>(<span style="color:#5af78e">&#34;9&#34;</span>, <span style="color:#5af78e">&#34;10&#34;</span>, <span style="color:#5af78e">&#34;11&#34;</span>, <span style="color:#5af78e">&#34;5&#34;</span>,<span style="color:#5af78e">&#34;8&#34;</span>, <span style="color:#5af78e">&#34;6&#34;</span>, <span style="color:#5af78e">&#34;7&#34;</span>, 
                         <span style="color:#5af78e">&#34;2&#34;</span>, <span style="color:#5af78e">&#34;4&#34;</span>, <span style="color:#5af78e">&#34;12&#34;</span>, <span style="color:#5af78e">&#34;#1&#34;</span>, <span style="color:#5af78e">&#34;1&#34;</span>, <span style="color:#5af78e">&#34;3&#34;</span>, <span style="color:#5af78e">&#34;#2&#34;</span>),
         <span style="color:#ff6ac1">!</span>speaker <span style="color:#ff6ac1">%in%</span> temp<span style="color:#ff6ac1">$</span>speaker)
</code></pre></div><p>There are a couple of other duplication issues I want to fix, for example &ldquo;Cigarette-Smoking Man&rdquo; vs. &ldquo;Cigarette Smoking Man&rdquo;. I also want to make sure all of Mulder and Scully&rsquo;s speaker names are uniform because I&rsquo;m definitely going to use them in the analysis.</p>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">ep_text <span style="color:#ff6ac1">&lt;-</span> ep_text <span style="color:#ff6ac1">%&gt;%</span>
  <span style="color:#57c7ff">mutate</span>(speaker <span style="color:#ff6ac1">=</span> <span style="color:#57c7ff">ifelse</span>(
    speaker <span style="color:#ff6ac1">%in%</span> <span style="color:#57c7ff">c</span>(
      <span style="color:#5af78e">&#34;1939 CIGARETTE SMOKING MAN&#34;</span>,
      <span style="color:#5af78e">&#34;CIGARETTE SMOKING MAN&#34;</span>,
      <span style="color:#5af78e">&#34;CIGARETTE-SMOKING MAN&#34;</span>,
      <span style="color:#5af78e">&#34;CANCERMAN&#34;</span>,
      <span style="color:#5af78e">&#34;CANCER MAN&#34;</span>
    ),
    <span style="color:#5af78e">&#34;CIGARETTE SMOKING MAN&#34;</span>,
    <span style="color:#57c7ff">ifelse</span>(
      speaker <span style="color:#ff6ac1">%in%</span> <span style="color:#57c7ff">c</span>(
        <span style="color:#5af78e">&#34;1989 MULDER&#34;</span>,
        <span style="color:#5af78e">&#34;MULDER&#34;</span>,
        <span style="color:#5af78e">&#34;MULDER AS MORRIS&#34;</span>,
        <span style="color:#5af78e">&#34;MULDER ON ANSWERING MACHINE&#34;</span>,
        <span style="color:#5af78e">&#34;MULDER ON RECORDER&#34;</span>,
        <span style="color:#5af78e">&#34;MULDER ON RECORDING&#34;</span>,
        <span style="color:#5af78e">&#34;MULDER VOICE OVER&#34;</span>,
        <span style="color:#5af78e">&#34;MULDER&#39;S VOICE&#34;</span>,
        <span style="color:#5af78e">&#34;MULDER&#39;S VOICE OVER&#34;</span>,
        <span style="color:#5af78e">&#34;VERY OLD MULDER&#34;</span>
      ),
      <span style="color:#5af78e">&#34;MULDER&#34;</span>,
      <span style="color:#57c7ff">ifelse</span>(
        speaker <span style="color:#ff6ac1">%in%</span> <span style="color:#57c7ff">c</span>(
          <span style="color:#5af78e">&#34;DANA&#34;</span>,
          <span style="color:#5af78e">&#34;1939 SCULLY&#34;</span>,
          <span style="color:#5af78e">&#34;FLASHBACK SCULLY&#34;</span>,
          <span style="color:#5af78e">&#34;SCULLY&#34;</span>,
          <span style="color:#5af78e">&#34;SCULLY ON MACHINE&#34;</span>,
          <span style="color:#5af78e">&#34;SCULLY ON TAPE&#34;</span>,
          <span style="color:#5af78e">&#34;SCULLY VOICE OVER&#34;</span>,
          <span style="color:#5af78e">&#34;SCULLY&#39;S VOICE OVER&#34;</span>
        ),
        <span style="color:#5af78e">&#34;SCULLY&#34;</span>,
        speaker
      )
    )
  )) <span style="color:#ff6ac1">%&gt;%</span>
  <span style="color:#57c7ff">mutate</span>(speaker <span style="color:#ff6ac1">=</span> <span style="color:#57c7ff">ifelse</span>(<span style="color:#57c7ff">str_detect</span>(speaker, <span style="color:#5af78e">&#34;MANICURE&#34;</span>), <span style="color:#5af78e">&#34;WELL-MANICURED MAN&#34;</span>, speaker)) <span style="color:#ff6ac1">%&gt;%</span>
  <span style="color:#57c7ff">mutate</span>(speaker <span style="color:#ff6ac1">=</span> <span style="color:#57c7ff">str_to_title</span>(speaker))
</code></pre></div><p>Now I&rsquo;ll join the table from the previous post, by episode number. I&rsquo;m going to save this dataset for the next post.</p>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">ep_text <span style="color:#ff6ac1">&lt;-</span> ep_text <span style="color:#ff6ac1">%&gt;%</span> 
  <span style="color:#57c7ff">rename</span>(<span style="color:#5af78e">&#34;no_overall&#34;</span> <span style="color:#ff6ac1">=</span> source,
         <span style="color:#5af78e">&#34;ep_title&#34;</span> <span style="color:#ff6ac1">=</span> title) <span style="color:#ff6ac1">%&gt;%</span> 
  <span style="color:#57c7ff">mutate</span>(no_overall <span style="color:#ff6ac1">=</span> <span style="color:#57c7ff">as.numeric</span>(no_overall)) <span style="color:#ff6ac1">%&gt;%</span> 
  <span style="color:#57c7ff">left_join</span>(table_df, by <span style="color:#ff6ac1">=</span> <span style="color:#5af78e">&#34;no_overall&#34;</span>) <span style="color:#ff6ac1">%&gt;%</span> 
  <span style="color:#57c7ff">mutate</span>(speaker <span style="color:#ff6ac1">=</span> <span style="color:#57c7ff">str_to_title</span>(speaker))
</code></pre></div><h2 id="plotting-number-of-lines-per-character">Plotting Number of Lines Per Character</h2>
<p>I&rsquo;m going to do the text analysis in the next post, because this file will take forever to run and if I need to make small adjustments it&rsquo;s going to be very time consuming. However, this post wouldn&rsquo;t be complete without a chart, would it?</p>
<p>Let&rsquo;s look at the number of lines each character has per season. Of course, for the sake of space I&rsquo;m just going to pick some of the main characters. I will also change the number of lines into a log scale just to even things out for the chart, because Mulder and Scully have the highest number of lines by a long shot, so the secondary characters will be harder to see.</p>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">speakers <span style="color:#ff6ac1">&lt;-</span> ep_text <span style="color:#ff6ac1">%&gt;%</span> 
  <span style="color:#57c7ff">count</span>(season, speaker) <span style="color:#ff6ac1">%&gt;%</span> 
  <span style="color:#57c7ff">filter</span>(speaker <span style="color:#ff6ac1">%in%</span> <span style="color:#57c7ff">c</span>(<span style="color:#5af78e">&#34;Mulder&#34;</span>, <span style="color:#5af78e">&#34;Scully&#34;</span>, <span style="color:#5af78e">&#34;Skinner&#34;</span>, <span style="color:#5af78e">&#34;Cigarette Smoking Man&#34;</span>, <span style="color:#5af78e">&#34;Frohike&#34;</span>, <span style="color:#5af78e">&#34;Langly&#34;</span>, <span style="color:#5af78e">&#34;Doggett&#34;</span>, <span style="color:#5af78e">&#34;Reyes&#34;</span>, <span style="color:#5af78e">&#34;Byers&#34;</span>,  <span style="color:#5af78e">&#34;X&#34;</span>, <span style="color:#5af78e">&#34;Deep Throat&#34;</span>, <span style="color:#5af78e">&#34;Well-Manicured Man&#34;</span>)) <span style="color:#ff6ac1">%&gt;%</span> 
  <span style="color:#57c7ff">arrange</span>(season, <span style="color:#57c7ff">desc</span>(n))

speakers<span style="color:#ff6ac1">&lt;-</span>speakers <span style="color:#ff6ac1">%&gt;%</span> 
  <span style="color:#57c7ff">mutate</span>(n2 <span style="color:#ff6ac1">=</span> <span style="color:#57c7ff">round</span>(<span style="color:#57c7ff">log</span>(n), <span style="color:#ff9f43">2</span>),
         speaker2 <span style="color:#ff6ac1">=</span> <span style="color:#57c7ff">factor</span>(speaker)) <span style="color:#ff6ac1">%&gt;%</span> 
  <span style="color:#57c7ff">mutate</span>(n2 <span style="color:#ff6ac1">=</span> <span style="color:#57c7ff">ifelse</span>(n2 <span style="color:#ff6ac1">&lt;</span><span style="color:#ff9f43">.5</span>,<span style="color:#ff9f43">.3</span>, n2))
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">speakers <span style="color:#ff6ac1">%&gt;%</span> 
  <span style="color:#57c7ff">ggplot</span>(<span style="color:#57c7ff">aes</span>(<span style="color:#57c7ff">fct_rev</span>(speaker2), n2,fill <span style="color:#ff6ac1">=</span>speaker2)) <span style="color:#ff6ac1">+</span>
  <span style="color:#57c7ff">geom_col</span>(show.legend <span style="color:#ff6ac1">=</span> <span style="color:#ff6ac1">FALSE</span>, width <span style="color:#ff6ac1">=</span> <span style="color:#ff9f43">.8</span>, position <span style="color:#ff6ac1">=</span> <span style="color:#57c7ff">position_dodge</span>(<span style="color:#ff9f43">0.7</span>))<span style="color:#ff6ac1">+</span>
  <span style="color:#57c7ff">facet_wrap</span>(<span style="color:#ff6ac1">~</span>season, nrow <span style="color:#ff6ac1">=</span> <span style="color:#ff9f43">3</span>)<span style="color:#ff6ac1">+</span>
  <span style="color:#57c7ff">scale_y_continuous</span>(limits <span style="color:#ff6ac1">=</span> <span style="color:#57c7ff">c</span>(<span style="color:#ff9f43">0</span>,<span style="color:#ff9f43">8</span>), expand <span style="color:#ff6ac1">=</span> <span style="color:#57c7ff">c</span>(<span style="color:#ff9f43">0</span>,<span style="color:#ff9f43">0</span>))<span style="color:#ff6ac1">+</span>
  <span style="color:#57c7ff">coord_flip</span>()<span style="color:#ff6ac1">+</span>
  <span style="color:#57c7ff">labs</span>(title <span style="color:#ff6ac1">=</span> <span style="color:#5af78e">&#34;Character Lines by Season&#34;</span>, y <span style="color:#ff6ac1">=</span> <span style="color:#5af78e">&#34;Number of Lines&#34;</span>)<span style="color:#ff6ac1">+</span>
  my_theme2
</code></pre></div><p><img src="https://kpress.dev/post/2020-11-01-the-truth-is-out-there-part-ii/index.en-us_files/figure-html/unnamed-chunk-15-1.png" width="720" /></p>
              
            </div>
          </div>
          <div id="post-footer" class="post-footer main-content-wrap">
            
              
                
                
                  <div class="post-footer-tags">
                    <span class="text-color-light text-small">TAGGED IN</span><br/>
                    
  <a class="tag tag--primary tag--small" href="https://kpress.dev/tags/web-scraping/">Web Scraping</a>

  <a class="tag tag--primary tag--small" href="https://kpress.dev/tags/x-files/">X-Files</a>

  <a class="tag tag--primary tag--small" href="https://kpress.dev/tags/datasets/">Datasets</a>

                  </div>
                
              
            
            <div class="post-actions-wrap">
  
      <nav >
        <ul class="post-actions post-action-nav">
          
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="https://kpress.dev/blog/2021-01-03-trust-no-one/" data-tooltip="Trust No One">
              
                  <i class="fa fa-angle-left"></i>
                  <span class="hide-xs hide-sm text-small icon-ml">NEXT</span>
                </a>
            </li>
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="https://kpress.dev/blog/2020-10-04-the-truth-is-out-there/" data-tooltip="The Truth Is Out There">
              
                  <span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
                  <i class="fa fa-angle-right"></i>
                </a>
            </li>
          
        </ul>
      </nav>
    <ul class="post-actions post-action-share" >
      
        <li class="post-action hide-lg hide-md hide-sm">
          <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions">
            <i class="fa fa-share-alt"></i>
          </a>
        </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=https://kpress.dev/blog/2020-11-01-i-want-to-believe/">
              <i class="fa fa-twitter"></i>
            </a>
          </li>
        
      
      
        <li class="post-action">
          <a class="post-action-btn btn btn--default" href="#disqus_thread">
            <i class="fa fa-comment-o"></i>
          </a>
        </li>
      
      <li class="post-action">
        
          <a class="post-action-btn btn btn--default" href="#">
        
          <i class="fa fa-list"></i>
        </a>
      </li>
    </ul>
  
</div>

            
              
                <div id="disqus_thread">
  <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
              
            
          </div>
        </article>
        <footer id="footer" class="main-content-wrap">
  <span class="copyrights">
    &copy; 2021 Katie Press. All Rights Reserved
  </span>
</footer>

      </div>
      <div id="bottom-bar" class="post-bottom-bar" data-behavior="5">
        <div class="post-actions-wrap">
  
      <nav >
        <ul class="post-actions post-action-nav">
          
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="https://kpress.dev/blog/2021-01-03-trust-no-one/" data-tooltip="Trust No One">
              
                  <i class="fa fa-angle-left"></i>
                  <span class="hide-xs hide-sm text-small icon-ml">NEXT</span>
                </a>
            </li>
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="https://kpress.dev/blog/2020-10-04-the-truth-is-out-there/" data-tooltip="The Truth Is Out There">
              
                  <span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
                  <i class="fa fa-angle-right"></i>
                </a>
            </li>
          
        </ul>
      </nav>
    <ul class="post-actions post-action-share" >
      
        <li class="post-action hide-lg hide-md hide-sm">
          <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions">
            <i class="fa fa-share-alt"></i>
          </a>
        </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=https://kpress.dev/blog/2020-11-01-i-want-to-believe/">
              <i class="fa fa-twitter"></i>
            </a>
          </li>
        
      
      
        <li class="post-action">
          <a class="post-action-btn btn btn--default" href="#disqus_thread">
            <i class="fa fa-comment-o"></i>
          </a>
        </li>
      
      <li class="post-action">
        
          <a class="post-action-btn btn btn--default" href="#">
        
          <i class="fa fa-list"></i>
        </a>
      </li>
    </ul>
  
</div>

      </div>
      <div id="share-options-bar" class="share-options-bar" data-behavior="5">
  <i id="btn-close-shareoptions" class="fa fa-close"></i>
  <ul class="share-options">
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://twitter.com/intent/tweet?text=https%3A%2F%2Fkpress.dev%2Fblog%2F2020-11-01-i-want-to-believe%2F">
          <i class="fa fa-twitter"></i><span>Share on Twitter</span>
        </a>
      </li>
    
  </ul>
</div>
<div id="share-options-mask" class="share-options-mask"></div>
    </div>
    
    <div id="about">
  <div id="about-card">
    <div id="about-btn-close">
      <i class="fa fa-remove"></i>
    </div>
    
      <img id="about-card-picture" src="https://kpress.dev/img/tuxedo.jpg" alt="Author&#39;s picture" />
    
    <h4 id="about-card-name">Katie Press</h4>
    
      <div id="about-card-bio">R Programmer, Data Enthusiast</div>
    
    
      <div id="about-card-job">
        <i class="fa fa-briefcase"></i>
        <br/>
        Researcher
      </div>
    
    
      <div id="about-card-location">
        <i class="fa fa-map-marker"></i>
        <br/>
        USA
      </div>
    
  </div>
</div>

    

    
  
    
      <div id="cover" style="background-image:url('https://kpress.dev/images/space3.jpg');"></div>
    
  


    
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js" integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js" integrity="sha256-/BfiIkHlHoVihZdc6TFuj7MmJ0TWcWsMXkeDFwhi0zw=" crossorigin="anonymous"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.7/js/jquery.fancybox.min.js" integrity="sha256-GEAnjcTqVP+vBp3SSc8bEDQqvWAZMiHyUSIorrWwH50=" crossorigin="anonymous"></script>


<script src="https://kpress.dev/js/script-pcw6v3xilnxydl1vddzazdverrnn9ctynvnxgwho987mfyqkuylcb1nlt.min.js"></script>


  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages.r.min.js"></script>
  

<script lang="javascript">
window.onload = updateMinWidth;
window.onresize = updateMinWidth;
document.getElementById("sidebar").addEventListener("transitionend", updateMinWidth);
function updateMinWidth() {
  var sidebar = document.getElementById("sidebar");
  var main = document.getElementById("main");
  main.style.minWidth = "";
  var w1 = getComputedStyle(main).getPropertyValue("min-width");
  var w2 = getComputedStyle(sidebar).getPropertyValue("width");
  var w3 = getComputedStyle(sidebar).getPropertyValue("left");
  main.style.minWidth = `calc(${w1} - ${w2} - ${w3})`;
}
</script>

<script>
$(document).ready(function() {
  hljs.configure({ classPrefix: '', useBR: false });
  $('pre.code-highlight > code, pre > code').each(function(i, block) {
    if (!$(this).hasClass('codeblock')) {
      $(this).addClass('codeblock');
    }
    hljs.highlightBlock(block);
  });
});
</script>


  
    
      <script>
        var disqus_config = function () {
          this.page.url = 'https:\/\/kpress.dev\/blog\/2020-11-01-i-want-to-believe\/';
          
            this.page.identifier = '\/blog\/2020-11-01-i-want-to-believe\/'
          
        };
        (function() {
          
          
          if (window.location.hostname == "localhost") {
            return;
          }
          var d = document, s = d.createElement('script');
          var disqus_shortname = 'blog-zxbl2vcnni';
          s.src = '//' + disqus_shortname + '.disqus.com/embed.js';

          s.setAttribute('data-timestamp', +new Date());
          (d.head || d.body).appendChild(s);
        })();
      </script>
    
  




    
  </body>
</html>

