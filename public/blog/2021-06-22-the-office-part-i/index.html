<!DOCTYPE html>
<html lang="en-us">
  <head>
    
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="generator" content="Hugo 0.87.0 with theme Tranquilpeak 0.4.8-BETA">
<meta name="author" content="Katie Press">
<meta name="keywords" content="">
<meta name="description" content="


























































































































































">


<meta property="og:description" content="


























































































































































">
<meta property="og:type" content="article">
<meta property="og:title" content="The Office Part I: Employee Attrition">
<meta name="twitter:title" content="The Office Part I: Employee Attrition">
<meta property="og:url" content="https://kpress.dev/blog/2021-06-22-the-office-part-i/">
<meta property="twitter:url" content="https://kpress.dev/blog/2021-06-22-the-office-part-i/">
<meta property="og:site_name" content="Blog Home">
<meta property="og:description" content="


























































































































































">
<meta name="twitter:description" content="


























































































































































">
<meta property="og:locale" content="en-us">

  
    <meta property="article:published_time" content="2021-06-22T00:00:00">
  
  
    <meta property="article:modified_time" content="2021-06-22T00:00:00">
  
  
  
    
      <meta property="article:section" content="Projects">
    
  
  
    
      <meta property="article:tag" content="Datasets">
    
      <meta property="article:tag" content="Modeling">
    
      <meta property="article:tag" content="The Office">
    
  


<meta name="twitter:card" content="summary">

  <meta name="twitter:site" content="@katie_press">


  <meta name="twitter:creator" content="@katie_press">






  <meta property="og:image" content="https://i.ibb.co/1G68FG5/jobrole-small.png">
  <meta property="twitter:image" content="https://i.ibb.co/1G68FG5/jobrole-small.png">


  <meta property="og:image" content="https://i.ibb.co/CP8vRZn/jobrole.png">
  <meta property="twitter:image" content="https://i.ibb.co/CP8vRZn/jobrole.png">




  <meta property="og:image" content="https://kpress.dev/img/tuxedo.jpg">
  <meta property="twitter:image" content="https://kpress.dev/img/tuxedo.jpg">


    <title>The Office Part I: Employee Attrition</title>

    <link rel="icon" href="https://kpress.dev/favicon.png">
    

    

    <link rel="canonical" href="https://kpress.dev/blog/2021-06-22-the-office-part-i/">

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/jquery.fancybox.min.css" integrity="sha256-vuXZ9LGmmwtjqFX1F+EKin1ThZMub58gKULUyf0qECk=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/helpers/jquery.fancybox-thumbs.min.css" integrity="sha256-SEa4XYAHihTcEP1f5gARTB2K26Uk8PsndQYHQC1f4jU=" crossorigin="anonymous" />
    
    
    <link rel="stylesheet" href="https://kpress.dev/css/style-twzjdbqhmnnacqs0pwwdzcdbt8yhv8giawvjqjmyfoqnvazl0dalmnhdkvp7.min.css" />
    
    
      
        <link rel="stylesheet" href="https://kpress.dev/static/css/custom.scss">
      
    

    
      
    
    
  </head>

  <body>
    <div id="blog">
      <header id="header" data-behavior="5">
  <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
  <div class="header-title">
    <a class="header-title-link" href="https://kpress.dev/">Blog Home</a>
  </div>
  
    
      <a class="header-right-picture "
         href="https://kpress.dev/#about">
    
    
    
      
        <img class="header-picture" src="https://kpress.dev/img/tuxedo.jpg" alt="Author&#39;s picture" />
      
    
    </a>
  
</header>

      <nav id="sidebar" data-behavior="5">
  <div class="sidebar-container">
    
      <div class="sidebar-profile">
        <a href="https://kpress.dev/#about">
          <img class="sidebar-profile-picture" src="https://kpress.dev/img/tuxedo.jpg" alt="Author&#39;s picture" />
        </a>
        <h4 class="sidebar-profile-name">Katie Press</h4>
        
          <h5 class="sidebar-profile-bio">R Programmer, Data Enthusiast</h5>
        
      </div>
    
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://kpress.dev/">
    
      <i class="sidebar-button-icon fa fa-lg fa-code"></i>
      
      <span class="sidebar-button-desc">Blog</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://kpress.dev/categories">
    
      <i class="sidebar-button-icon fa fa-lg fa-sitemap"></i>
      
      <span class="sidebar-button-desc">Categories</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://kpress.dev/tags">
    
      <i class="sidebar-button-icon fa fa-lg fa-hashtag"></i>
      
      <span class="sidebar-button-desc">Tags</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://kpress.dev/archives">
    
      <i class="sidebar-button-icon fa fa-lg fa-floppy-o"></i>
      
      <span class="sidebar-button-desc">Archives</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://github.com/katiepress" target="_blank" rel="noopener">
    
      <i class="sidebar-button-icon fa fa-lg fa-github"></i>
      
      <span class="sidebar-button-desc">GitHub</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      

    </ul>
  </div>
</nav>

      
  <div class="post-header-cover
              text-center
              "
       style="background-image:url('https://i.ibb.co/CP8vRZn/jobrole.png')"
       data-behavior="5">
    
      <div class="post-header main-content-wrap text-center">
  
    <h1 class="post-title" itemprop="headline">
      The Office Part I: Employee Attrition
    </h1>
  
  
  <div class="postShorten-meta post-meta">
    
      <time itemprop="datePublished" datetime="2021-06-22T00:00:00Z">
        
  June 22, 2021

      </time>
    
    
  
  
    <span>in</span>
    
      <a class="category-link" href="https://kpress.dev/categories/projects">Projects</a>
    
  

  </div>

</div>
    
  </div>


      <div id="main" data-behavior="5"
        class="hasCover
               hasCoverMetaIn
               ">
        <article class="post" itemscope itemType="http://schema.org/BlogPosting">
          
          
          <div class="post-content markdown" itemprop="articleBody">
            <div class="main-content-wrap">
              <script src="https://kpress.dev/rmarkdown-libs/core-js/shim.min.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/react/react.min.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/react/react-dom.min.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/reactwidget/react-tools.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/htmlwidgets/htmlwidgets.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/reactable-binding/reactable.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/core-js/shim.min.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/react/react.min.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/react/react-dom.min.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/reactwidget/react-tools.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/htmlwidgets/htmlwidgets.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/reactable-binding/reactable.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/core-js/shim.min.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/react/react.min.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/react/react-dom.min.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/reactwidget/react-tools.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/htmlwidgets/htmlwidgets.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/reactable-binding/reactable.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/core-js/shim.min.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/react/react.min.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/react/react-dom.min.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/reactwidget/react-tools.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/htmlwidgets/htmlwidgets.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/reactable-binding/reactable.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/core-js/shim.min.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/react/react.min.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/react/react-dom.min.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/reactwidget/react-tools.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/htmlwidgets/htmlwidgets.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/reactable-binding/reactable.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/core-js/shim.min.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/react/react.min.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/react/react-dom.min.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/reactwidget/react-tools.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/htmlwidgets/htmlwidgets.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/reactable-binding/reactable.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/core-js/shim.min.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/react/react.min.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/react/react-dom.min.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/reactwidget/react-tools.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/htmlwidgets/htmlwidgets.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/reactable-binding/reactable.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/core-js/shim.min.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/react/react.min.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/react/react-dom.min.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/reactwidget/react-tools.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/htmlwidgets/htmlwidgets.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/reactable-binding/reactable.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/core-js/shim.min.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/react/react.min.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/react/react-dom.min.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/reactwidget/react-tools.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/htmlwidgets/htmlwidgets.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/reactable-binding/reactable.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/core-js/shim.min.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/react/react.min.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/react/react-dom.min.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/reactwidget/react-tools.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/htmlwidgets/htmlwidgets.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/reactable-binding/reactable.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/core-js/shim.min.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/react/react.min.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/react/react-dom.min.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/reactwidget/react-tools.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/htmlwidgets/htmlwidgets.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/reactable-binding/reactable.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/core-js/shim.min.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/react/react.min.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/react/react-dom.min.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/reactwidget/react-tools.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/htmlwidgets/htmlwidgets.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/reactable-binding/reactable.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/core-js/shim.min.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/react/react.min.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/react/react-dom.min.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/reactwidget/react-tools.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/htmlwidgets/htmlwidgets.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/reactable-binding/reactable.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/core-js/shim.min.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/react/react.min.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/react/react-dom.min.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/reactwidget/react-tools.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/htmlwidgets/htmlwidgets.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/reactable-binding/reactable.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/core-js/shim.min.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/react/react.min.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/react/react-dom.min.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/reactwidget/react-tools.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/htmlwidgets/htmlwidgets.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/reactable-binding/reactable.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/core-js/shim.min.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/react/react.min.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/react/react-dom.min.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/reactwidget/react-tools.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/htmlwidgets/htmlwidgets.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/reactable-binding/reactable.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/core-js/shim.min.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/react/react.min.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/react/react-dom.min.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/reactwidget/react-tools.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/htmlwidgets/htmlwidgets.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/reactable-binding/reactable.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/core-js/shim.min.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/react/react.min.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/react/react-dom.min.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/reactwidget/react-tools.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/htmlwidgets/htmlwidgets.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/reactable-binding/reactable.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/core-js/shim.min.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/react/react.min.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/react/react-dom.min.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/reactwidget/react-tools.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/htmlwidgets/htmlwidgets.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/reactable-binding/reactable.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/core-js/shim.min.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/react/react.min.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/react/react-dom.min.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/reactwidget/react-tools.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/htmlwidgets/htmlwidgets.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/reactable-binding/reactable.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/core-js/shim.min.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/react/react.min.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/react/react-dom.min.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/reactwidget/react-tools.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/htmlwidgets/htmlwidgets.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/reactable-binding/reactable.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/core-js/shim.min.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/react/react.min.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/react/react-dom.min.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/reactwidget/react-tools.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/htmlwidgets/htmlwidgets.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/reactable-binding/reactable.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/core-js/shim.min.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/react/react.min.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/react/react-dom.min.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/reactwidget/react-tools.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/htmlwidgets/htmlwidgets.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/reactable-binding/reactable.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/core-js/shim.min.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/react/react.min.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/react/react-dom.min.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/reactwidget/react-tools.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/htmlwidgets/htmlwidgets.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/reactable-binding/reactable.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/core-js/shim.min.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/react/react.min.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/react/react-dom.min.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/reactwidget/react-tools.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/htmlwidgets/htmlwidgets.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/reactable-binding/reactable.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/core-js/shim.min.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/react/react.min.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/react/react-dom.min.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/reactwidget/react-tools.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/htmlwidgets/htmlwidgets.js"></script>
<script src="https://kpress.dev/rmarkdown-libs/reactable-binding/reactable.js"></script>
<h1 id="background">Background</h1>
<p>This post is partially inspired by one of my favorite blogs ever, <a href="https://www.askamanager.org">Ask a Manager</a>. I am obsessed with this content - partly because Alison (the writer) is super smart and gives good advice, partly for the pure entertainment value. I’ll be linking to some great posts along the way, but in the meantime here is a <a href="https://www.askamanager.org/favorite-posts">list of Alison’s favorite posts ever</a>.</p>
<p>In the past whenever I needed to create a predictive model, I was always frustrated because I wanted to know what the best model would be given all possible combinations of variables. But you wouldn’t want to test all combinations of all variables, because some of them are too similar and would over-inflate the model. For example, I wouldn’t use a variable like “age at event x” and another variable “age over 18 at event x” in one model.</p>
<p>A few weeks ago I was taking an online Python course and the course was covering truth tables, which look like this:</p>
<div id="htmlwidget-1" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-1">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"A":["T","T","F","F"],"B":["T","F","T","F"],"A or B":["T","T","T","F"]},"columns":[{"accessor":"A","name":"A","type":"character"},{"accessor":"B","name":"B","type":"character"},{"accessor":"A or B","name":"A or B","type":"character"}],"defaultPageSize":10,"paginationType":"numbers","showPageInfo":true,"minRows":1,"highlight":true,"bordered":true,"striped":true,"compact":true,"nowrap":true,"dataKey":"3cfd29b6f3d066606c9d8f2556fa7b45","key":"3cfd29b6f3d066606c9d8f2556fa7b45"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<p>In order for the third column (A or B) to be true, either A or B, or both A and B need to be true.</p>
<p>I realized I needed to do was figure out how to recreate a truth table where each column represents a group of potential variables for the model. This post is based on a real project, but I needed some publicly-available data to demonstrate with. I know there is a heart disease that is often used for prediction, but that’s kind of…boring. Also there weren’t that many variables.</p>
<p>Then I came across this HR employee attrition dataset on <a href="https://www.kaggle.com/vjchoudhary7/hr-analytics-case-study?select=general_data.csv">Kaggle</a> and thought that might be more interesting, given some of the crazy stories I’ve read on Ask a Manager over the years that often resulted in people leaving,, sometimes in rather <a href="https://www.askamanager.org/2017/10/resigning-via-cod-a-glorious-out-of-office-message-and-other-quitting-stories.html">spectacular fashion</a>.</p>
<p>In this post I’ll cover a little bit of data import and cleaning, visualization, and finally how to create a <em>bunch</em> of models at once. I’ve loaded the following packages:</p>
<ul>
<li>tidyverse</li>
<li>lubridate</li>
<li>janitor</li>
<li>knitr</li>
<li>ggplot2</li>
<li>readxl</li>
<li>ggridges</li>
<li>broom</li>
<li>glue</li>
</ul>
<h1 id="data-import">Data Import</h1>
<p>I downloaded the csv files from <a href="https://www.kaggle.com/vjchoudhary7/hr-analytics-case-study?select=general_data.csv">Kaggle</a> and created an R Project in the same folder.</p>
<ul>
<li>Get list of csv files</li>
<li>Use purrr::map to read csv into a list of tibbles</li>
<li>Name the tibbles in the list (this is why I put “full.names = TRUE”)</li>
<li>Map over the tibbles with janitor’s clean_names function to make the column names all lower case separated by underscores.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">temp.list <span style="color:#ff6ac1">&lt;-</span> <span style="color:#57c7ff">list.files</span>(full.names <span style="color:#ff6ac1">=</span> <span style="color:#ff6ac1">TRUE</span>, pattern <span style="color:#ff6ac1">=</span> <span style="color:#5af78e">&#34;*.csv&#34;</span>, path <span style="color:#ff6ac1">=</span> <span style="color:#5af78e">&#34;~/Desktop/Rproj/employee/&#34;</span>)

data_list <span style="color:#ff6ac1">&lt;-</span> <span style="color:#57c7ff">map</span>(temp.list, read_csv)

<span style="color:#57c7ff">names</span>(data_list) <span style="color:#ff6ac1">&lt;-</span> <span style="color:#57c7ff">word</span>(temp.list, <span style="color:#ff9f43">-2</span>, sep <span style="color:#ff6ac1">=</span> <span style="color:#5af78e">&#34;/|\\.csv&#34;</span>)

data_list <span style="color:#ff6ac1">&lt;-</span> data_list <span style="color:#ff6ac1">%&gt;%</span> 
  <span style="color:#57c7ff">map</span>( <span style="color:#ff6ac1">~</span>.x <span style="color:#ff6ac1">%&gt;%</span> clean_names)
</code></pre></div><p>I have a list of five tibbles, two of which are timestamp datasets and not in tidy format yet.</p>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#57c7ff">summary</span>(data_list)
</code></pre></div><pre><code>##                      Length Class       Mode
## employee_survey_data   4    spec_tbl_df list
## general_data          24    spec_tbl_df list
## in_time              262    spec_tbl_df list
## manager_survey_data    3    spec_tbl_df list
## out_time             262    spec_tbl_df list
</code></pre>
<h2 id="general-data">General Data</h2>
<p>We have a general dataset, a manager survey, and an employee survey. These three tables can be joined on employee ID.</p>
<p>Side note: If you are a manager, try not to force your employees to <a href="https://www.askamanager.org/2020/07/my-manager-makes-us-do-mental-health-surveys-every-day.html">complete a daily mental health survey</a>, it’s not a great look and <a href="https://www.askamanager.org/2020/12/update-my-manager-makes-us-do-mental-health-surveys-every-day.html">they’ll probably all quit</a>.</p>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">data <span style="color:#ff6ac1">&lt;-</span> data_list<span style="color:#ff6ac1">$</span>general_data <span style="color:#ff6ac1">%&gt;%</span>
  <span style="color:#57c7ff">left_join</span>(data_list<span style="color:#ff6ac1">$</span>employee_survey_data) <span style="color:#ff6ac1">%&gt;%</span>
  <span style="color:#57c7ff">left_join</span>(data_list<span style="color:#ff6ac1">$</span>manager_survey_data) <span style="color:#ff6ac1">%&gt;%</span>
  <span style="color:#57c7ff">select</span>(employee_id, <span style="color:#57c7ff">everything</span>())
</code></pre></div><h2 id="time-data">Time Data</h2>
<p>This is what the time data looks like currently. Notice each column is a date, except for the first one which corresponds to the employee ID. This is exactly what tidyr is for.</p>
<div id="htmlwidget-2" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-2">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"x1":[1,2,3,4,5,6],"x2015_01_01":[null,null,null,null,null,null],"x2015_01_02":["2015-01-02T09:43:45","2015-01-02T10:15:44","2015-01-02T10:17:41","2015-01-02T10:05:06","2015-01-02T10:28:17","2015-01-02T09:43:08"],"x2015_01_05":["2015-01-05T10:08:48","2015-01-05T10:21:05","2015-01-05T09:50:50","2015-01-05T09:56:32","2015-01-05T09:49:58","2015-01-05T10:14:00"],"x2015_01_06":["2015-01-06T09:54:26",null,"2015-01-06T10:14:13","2015-01-06T10:11:07","2015-01-06T09:45:28","2015-01-06T10:08:42"],"x2015_01_07":["2015-01-07T09:34:31","2015-01-07T09:45:17","2015-01-07T09:47:27","2015-01-07T09:37:30","2015-01-07T09:49:37","2015-01-07T10:18:15"]},"columns":[{"accessor":"x1","name":"x1","type":"numeric"},{"accessor":"x2015_01_01","name":"x2015_01_01","type":"logical"},{"accessor":"x2015_01_02","name":"x2015_01_02","type":"Date"},{"accessor":"x2015_01_05","name":"x2015_01_05","type":"Date"},{"accessor":"x2015_01_06","name":"x2015_01_06","type":"Date"},{"accessor":"x2015_01_07","name":"x2015_01_07","type":"Date"}],"defaultPageSize":10,"paginationType":"numbers","showPageInfo":true,"minRows":1,"highlight":true,"bordered":true,"striped":true,"compact":true,"nowrap":true,"dataKey":"726fca72279d9c6f2e6441b64b1ca6fc","key":"726fca72279d9c6f2e6441b64b1ca6fc"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<p>Using pivot_longer, I can preserve the employee ID in one column, put the date in another column, and the timestamp in a third column. I usually use lubridate to format dates, in this case I also had to get rid of the “x” at the beginning of the character because otherwise it would be NA. I’m also going to add the timestamps for clocking out.</p>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">time_data <span style="color:#ff6ac1">&lt;-</span> data_list<span style="color:#ff6ac1">$</span>in_time <span style="color:#ff6ac1">%&gt;%</span>
  <span style="color:#57c7ff">pivot_longer</span>(<span style="color:#ff6ac1">!</span>x1, names_to <span style="color:#ff6ac1">=</span> <span style="color:#5af78e">&#34;date&#34;</span>, values_to <span style="color:#ff6ac1">=</span> <span style="color:#5af78e">&#34;time_in&#34;</span>) <span style="color:#ff6ac1">%&gt;%</span>
  <span style="color:#57c7ff">mutate</span>(date <span style="color:#ff6ac1">=</span> <span style="color:#57c7ff">ymd</span>(<span style="color:#57c7ff">str_remove_all</span>(date, <span style="color:#5af78e">&#34;x&#34;</span>))) <span style="color:#ff6ac1">%&gt;%</span>
  <span style="color:#57c7ff">left_join</span>(
    data_list<span style="color:#ff6ac1">$</span>out_time <span style="color:#ff6ac1">%&gt;%</span>
      <span style="color:#57c7ff">pivot_longer</span>(<span style="color:#ff6ac1">!</span>x1, names_to <span style="color:#ff6ac1">=</span> <span style="color:#5af78e">&#34;date&#34;</span>, values_to <span style="color:#ff6ac1">=</span> <span style="color:#5af78e">&#34;time_out&#34;</span>) <span style="color:#ff6ac1">%&gt;%</span>
      <span style="color:#57c7ff">mutate</span>(date <span style="color:#ff6ac1">=</span> <span style="color:#57c7ff">ymd</span>(<span style="color:#57c7ff">str_remove_all</span>(date, <span style="color:#5af78e">&#34;x&#34;</span>)))
  ) <span style="color:#ff6ac1">%&gt;%</span> 
  <span style="color:#57c7ff">rename</span>(<span style="color:#5af78e">&#34;employee_id&#34;</span> <span style="color:#ff6ac1">=</span> x1)
</code></pre></div><p>Create some additional variables for aggregation later. This would be especially useful for any <a href="https://www.askamanager.org/2015/01/my-coworker-is-trying-to-track-my-hours-and-pto.html">nosy coworkers</a> who might want to <a href="https://www.askamanager.org/2014/09/my-coworker-is-tracking-my-hours.html">track your hours</a>.</p>
<ul>
<li>Number of hours worked each day</li>
<li>Week column</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">time_data <span style="color:#ff6ac1">&lt;-</span> time_data <span style="color:#ff6ac1">%&gt;%</span> 
  <span style="color:#57c7ff">mutate</span>(hours <span style="color:#ff6ac1">=</span> <span style="color:#57c7ff">round</span>(<span style="color:#57c7ff">time_length</span>(time_in <span style="color:#ff6ac1">%--%</span> time_out, <span style="color:#5af78e">&#34;hour&#34;</span>), <span style="color:#ff9f43">2</span>)) <span style="color:#ff6ac1">%&gt;%</span> 
  <span style="color:#57c7ff">mutate</span>(hours <span style="color:#ff6ac1">=</span> <span style="color:#57c7ff">replace_na</span>(hours, <span style="color:#ff9f43">0</span>)) <span style="color:#ff6ac1">%&gt;%</span> 
  <span style="color:#57c7ff">mutate</span>(week <span style="color:#ff6ac1">=</span> <span style="color:#57c7ff">week</span>(date))
</code></pre></div><p>Much better</p>
<div id="htmlwidget-3" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-3">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"employee_id":[1,1,1,1,1,1],"date":["2015-01-01","2015-01-02","2015-01-05","2015-01-06","2015-01-07","2015-01-08"],"time_in":[null,"2015-01-02T09:43:45","2015-01-05T10:08:48","2015-01-06T09:54:26","2015-01-07T09:34:31","2015-01-08T09:51:09"],"time_out":[null,"2015-01-02T16:56:15","2015-01-05T17:20:11","2015-01-06T17:19:05","2015-01-07T16:34:55","2015-01-08T17:08:32"],"hours":[0,7.21,7.19,7.41,7.01,7.29],"week":[1,1,1,1,1,2]},"columns":[{"accessor":"employee_id","name":"employee_id","type":"numeric"},{"accessor":"date","name":"date","type":"Date"},{"accessor":"time_in","name":"time_in","type":"Date"},{"accessor":"time_out","name":"time_out","type":"Date"},{"accessor":"hours","name":"hours","type":"numeric"},{"accessor":"week","name":"week","type":"numeric"}],"defaultPageSize":10,"paginationType":"numbers","showPageInfo":true,"minRows":1,"highlight":true,"bordered":true,"striped":true,"compact":true,"nowrap":true,"dataKey":"0015e5d04f9520b79749239f5f043de6","key":"0015e5d04f9520b79749239f5f043de6"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<h1 id="data-cleaning">Data Cleaning</h1>
<p>Using the data dictionary Excel file provided from Kaggle, I’m recoding some of the numeric variables as factors for better visualization in charts. Also create a numeric variable for attrition (to be used later in modeling).</p>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">data <span style="color:#ff6ac1">&lt;-</span> data <span style="color:#ff6ac1">%&gt;%</span>
  <span style="color:#57c7ff">mutate</span>(education_2 <span style="color:#ff6ac1">=</span> <span style="color:#57c7ff">factor</span>(
    education,
    labels <span style="color:#ff6ac1">=</span> <span style="color:#57c7ff">c</span>(<span style="color:#5af78e">&#34;Below College&#34;</span>, <span style="color:#5af78e">&#34;College&#34;</span>, <span style="color:#5af78e">&#34;Bachelors&#34;</span>, <span style="color:#5af78e">&#34;Masters&#34;</span>, <span style="color:#5af78e">&#34;Doctoral&#34;</span>),
    ordered <span style="color:#ff6ac1">=</span> <span style="color:#ff6ac1">TRUE</span>
  )) <span style="color:#ff6ac1">%&gt;%</span>
  <span style="color:#57c7ff">mutate</span>(<span style="color:#57c7ff">across</span>(
    <span style="color:#57c7ff">one_of</span>(
      <span style="color:#5af78e">&#34;environment_satisfaction&#34;</span>,
      <span style="color:#5af78e">&#34;job_involvement&#34;</span>,
      <span style="color:#5af78e">&#34;job_satisfaction&#34;</span>
    ),
    <span style="color:#57c7ff">list</span>(<span style="color:#5af78e">&#34;2&#34;</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff6ac1">~</span> <span style="color:#57c7ff">factor</span>(
      ., labels <span style="color:#ff6ac1">=</span> <span style="color:#57c7ff">c</span>(<span style="color:#5af78e">&#34;Low&#34;</span>, <span style="color:#5af78e">&#34;Medium&#34;</span>, <span style="color:#5af78e">&#34;High&#34;</span>, <span style="color:#5af78e">&#34;Very High&#34;</span>),
      ordered <span style="color:#ff6ac1">=</span> <span style="color:#ff6ac1">TRUE</span>
    ))
  )) <span style="color:#ff6ac1">%&gt;%</span>
  <span style="color:#57c7ff">mutate</span>(performance_rating_2 <span style="color:#ff6ac1">=</span> <span style="color:#57c7ff">factor</span>(performance_rating, 
                                       labels <span style="color:#ff6ac1">=</span> <span style="color:#57c7ff">c</span>(<span style="color:#5af78e">&#34;Excellent&#34;</span>, <span style="color:#5af78e">&#34;Outstanding&#34;</span>),
                                       ordered <span style="color:#ff6ac1">=</span> <span style="color:#ff6ac1">TRUE</span>)) <span style="color:#ff6ac1">%&gt;%</span>
  <span style="color:#57c7ff">mutate</span>(work_life_balance_2 <span style="color:#ff6ac1">=</span> <span style="color:#57c7ff">factor</span>(work_life_balance, 
                                      labels <span style="color:#ff6ac1">=</span> <span style="color:#57c7ff">c</span>(<span style="color:#5af78e">&#34;Bad&#34;</span>, <span style="color:#5af78e">&#34;Good&#34;</span>, <span style="color:#5af78e">&#34;Better&#34;</span>, <span style="color:#5af78e">&#34;Best&#34;</span>),
                                      ordered <span style="color:#ff6ac1">=</span> <span style="color:#ff6ac1">TRUE</span>)) <span style="color:#ff6ac1">%&gt;%</span> 
  <span style="color:#57c7ff">mutate</span>(business_travel <span style="color:#ff6ac1">=</span> <span style="color:#57c7ff">str_replace_all</span>(business_travel, <span style="color:#5af78e">&#34;_&#34;</span>, <span style="color:#5af78e">&#34; &#34;</span>)) <span style="color:#ff6ac1">%&gt;%</span> 
  <span style="color:#57c7ff">mutate</span>(attrition_2 <span style="color:#ff6ac1">=</span> <span style="color:#57c7ff">ifelse</span>(attrition <span style="color:#ff6ac1">==</span> <span style="color:#5af78e">&#34;Yes&#34;</span>, <span style="color:#ff9f43">1</span>, <span style="color:#ff9f43">0</span>))
</code></pre></div><p>Aggregate the timestamp data down to average hours worked per week and add to the dataset.</p>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">data <span style="color:#ff6ac1">&lt;-</span> time_data <span style="color:#ff6ac1">%&gt;%</span> 
  <span style="color:#57c7ff">group_by</span>(employee_id, week) <span style="color:#ff6ac1">%&gt;%</span> 
  <span style="color:#57c7ff">summarise</span>(week_hours <span style="color:#ff6ac1">=</span> <span style="color:#57c7ff">sum</span>(hours)) <span style="color:#ff6ac1">%&gt;%</span> 
  <span style="color:#57c7ff">group_by</span>(employee_id) <span style="color:#ff6ac1">%&gt;%</span> 
  <span style="color:#57c7ff">summarise</span>(avg_weekly_hours <span style="color:#ff6ac1">=</span> <span style="color:#57c7ff">round</span>(<span style="color:#57c7ff">mean</span>(week_hours, na.rm<span style="color:#ff6ac1">=</span><span style="color:#ff6ac1">TRUE</span>))) <span style="color:#ff6ac1">%&gt;%</span> 
  <span style="color:#57c7ff">right_join</span>(data)
</code></pre></div><h1 id="data-viz">Data Viz</h1>
<p>Checking out some of the numeric variables, I can plot multiple histograms using ggplot and facet_wrap. And here are some fun Ask a Manager posts to go along with them:</p>
<ul>
<li>A reader’s direct report is <a href="https://www.askamanager.org/2016/04/my-older-employee-has-an-issue-with-my-age.html">obsessed with her age</a></li>
<li>What to do when <a href="https://www.askamanager.org/2019/08/my-boss-lectured-me-about-arriving-on-time-when-im-working-a-ton-of-hours.html">you’re working crazy hours and your boss reprimands you for coming in late</a></li>
<li>If you’re an entry level employee, maybe think twice before <a href="https://www.askamanager.org/2018/10/my-entry-level-employee-gave-me-a-bunch-of-off-base-constructive-criticism.html">giving your manager “constructive” feedback</a></li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">data <span style="color:#ff6ac1">%&gt;%</span> 
  <span style="color:#57c7ff">select</span>(<span style="color:#5af78e">&#34;Age&#34;</span> <span style="color:#ff6ac1">=</span> age, 
         <span style="color:#5af78e">&#34;Average Weekly Hours&#34;</span> <span style="color:#ff6ac1">=</span> avg_weekly_hours, 
         <span style="color:#5af78e">&#34;Job Level&#34;</span> <span style="color:#ff6ac1">=</span> job_level,
         <span style="color:#5af78e">&#34;Number of Companies Worked&#34;</span> <span style="color:#ff6ac1">=</span> num_companies_worked, 
         <span style="color:#5af78e">&#34;Total Working Years&#34;</span> <span style="color:#ff6ac1">=</span> total_working_years, 
         <span style="color:#5af78e">&#34;Training Times Last Year&#34;</span> <span style="color:#ff6ac1">=</span> training_times_last_year, 
         <span style="color:#5af78e">&#34;Years at Company&#34;</span> <span style="color:#ff6ac1">=</span> years_at_company,
         <span style="color:#5af78e">&#34;Years Since Last Promotion&#34;</span> <span style="color:#ff6ac1">=</span> years_since_last_promotion,
         <span style="color:#5af78e">&#34;Years with Current Manager&#34;</span> <span style="color:#ff6ac1">=</span> years_with_curr_manager) <span style="color:#ff6ac1">%&gt;%</span> 
  <span style="color:#57c7ff">gather</span>(item, number) <span style="color:#ff6ac1">%&gt;%</span> 
  <span style="color:#57c7ff">ggplot</span>(<span style="color:#57c7ff">aes</span>(number, color <span style="color:#ff6ac1">=</span> item, fill <span style="color:#ff6ac1">=</span> item))<span style="color:#ff6ac1">+</span>
  <span style="color:#57c7ff">geom_histogram</span>(binwidth <span style="color:#ff6ac1">=</span> <span style="color:#ff9f43">1</span>)<span style="color:#ff6ac1">+</span>
  <span style="color:#57c7ff">facet_wrap</span>(<span style="color:#ff6ac1">~</span>item, scales <span style="color:#ff6ac1">=</span> <span style="color:#5af78e">&#34;free&#34;</span>)<span style="color:#ff6ac1">+</span>
  my_theme <span style="color:#ff6ac1">+</span>
  <span style="color:#57c7ff">theme</span>(legend.position <span style="color:#ff6ac1">=</span> <span style="color:#5af78e">&#34;none&#34;</span>,
        axis.text.y <span style="color:#ff6ac1">=</span> <span style="color:#57c7ff">element_blank</span>(),
        axis.title.y <span style="color:#ff6ac1">=</span> <span style="color:#57c7ff">element_blank</span>(),
        axis.title.x <span style="color:#ff6ac1">=</span> <span style="color:#57c7ff">element_blank</span>(),
        axis.ticks.y <span style="color:#ff6ac1">=</span> <span style="color:#57c7ff">element_blank</span>())
</code></pre></div><p><img src="https://kpress.dev/post/2021-06-21-the-office-part-i/index.en-us_files/figure-html/unnamed-chunk-13-1.png" width="672" style="display: block; margin: auto;" /></p>
<h2 id="bar-charts">Bar Charts</h2>
<p>For the categorical variables it’s not quite as easy to plot multiple charts at once. But I can start by nesting the data. This gives me a list of dataframes - one for every item I want to plot.</p>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">plot_data <span style="color:#ff6ac1">&lt;-</span> data <span style="color:#ff6ac1">%&gt;%</span> 
  <span style="color:#57c7ff">select</span>(<span style="color:#5af78e">&#34;Gender&#34;</span> <span style="color:#ff6ac1">=</span> gender,
         <span style="color:#5af78e">&#34;Marital Status&#34;</span> <span style="color:#ff6ac1">=</span> marital_status,
         <span style="color:#5af78e">&#34;Business Travel&#34;</span> <span style="color:#ff6ac1">=</span> business_travel,
         <span style="color:#5af78e">&#34;Work Life Balance&#34;</span> <span style="color:#ff6ac1">=</span> work_life_balance_2,
         
         <span style="color:#5af78e">&#34;Education&#34;</span> <span style="color:#ff6ac1">=</span> education_2,
         <span style="color:#5af78e">&#34;Education Field&#34;</span> <span style="color:#ff6ac1">=</span> education_field,
         <span style="color:#5af78e">&#34;Department&#34;</span> <span style="color:#ff6ac1">=</span> department,
         <span style="color:#5af78e">&#34;Job Role&#34;</span> <span style="color:#ff6ac1">=</span> job_role,
         
         <span style="color:#5af78e">&#34;Environment Satisfaction&#34;</span> <span style="color:#ff6ac1">=</span> environment_satisfaction_2,
         <span style="color:#5af78e">&#34;Job Involvement&#34;</span> <span style="color:#ff6ac1">=</span> job_involvement_2,
         <span style="color:#5af78e">&#34;Job Satisfaction&#34;</span> <span style="color:#ff6ac1">=</span> job_satisfaction_2,
         <span style="color:#5af78e">&#34;Performance Rating&#34;</span> <span style="color:#ff6ac1">=</span> performance_rating_2
         ) <span style="color:#ff6ac1">%&gt;%</span> 
  <span style="color:#57c7ff">gather</span>(item, thing) <span style="color:#ff6ac1">%&gt;%</span> 
  <span style="color:#57c7ff">count</span>(item, thing) <span style="color:#ff6ac1">%&gt;%</span> 
  <span style="color:#57c7ff">group_by</span>(item) <span style="color:#ff6ac1">%&gt;%</span> 
  <span style="color:#57c7ff">mutate</span>(pct <span style="color:#ff6ac1">=</span> n<span style="color:#ff6ac1">/</span><span style="color:#57c7ff">sum</span>(n)) <span style="color:#ff6ac1">%&gt;%</span> 
  <span style="color:#57c7ff">group_nest</span>(data <span style="color:#ff6ac1">=</span> item)
</code></pre></div><div id="htmlwidget-4" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-4">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"item":["Business Travel","Department","Education","Education Field","Environment Satisfaction","Gender"],"data":[{"thing":["Non-Travel","Travel Frequently","Travel Rarely"],"n":[450,831,3129],"pct":[0.102040816326531,0.18843537414966,0.70952380952381]},{"thing":["Human Resources","Research & Development","Sales"],"n":[189,2883,1338],"pct":[0.0428571428571429,0.653741496598639,0.303401360544218]},{"thing":["Bachelors","Below College","College","Doctoral","Masters"],"n":[1716,510,846,144,1194],"pct":[0.389115646258503,0.115646258503401,0.191836734693878,0.0326530612244898,0.270748299319728]},{"thing":["Human Resources","Life Sciences","Marketing","Medical","Other","Technical Degree"],"n":[81,1818,477,1392,246,396],"pct":[0.0183673469387755,0.412244897959184,0.108163265306122,0.315646258503401,0.0557823129251701,0.0897959183673469]},{"thing":["High","Low","Medium","Very High",null],"n":[1350,845,856,1334,25],"pct":[0.306122448979592,0.191609977324263,0.194104308390023,0.30249433106576,0.00566893424036281]},{"thing":["Female","Male"],"n":[1764,2646],"pct":[0.4,0.6]}]},"columns":[{"accessor":"item","name":"item","type":"character"},{"accessor":"data","name":"data","type":["vctrs_list_of","vctrs_vctr","list"]}],"defaultPageSize":10,"paginationType":"numbers","showPageInfo":true,"minRows":1,"highlight":true,"bordered":true,"striped":true,"compact":true,"nowrap":true,"dataKey":"05139e9d55802da7d1972ec5ba5bb2ac","key":"05139e9d55802da7d1972ec5ba5bb2ac"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<p>Now I can use map to iterate over the dataframes with my ggplot code. I’m actually using map2 here so that I can use the “item” column as titles for the charts (pasted in using glue). Now I have the plots in a new column and I can print them out.</p>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">plot_data <span style="color:#ff6ac1">&lt;-</span> plot_data <span style="color:#ff6ac1">%&gt;%</span>
  <span style="color:#57c7ff">mutate</span>(
    plot <span style="color:#ff6ac1">=</span> <span style="color:#57c7ff">map2</span>(
      data,
      item,
      <span style="color:#ff6ac1">~</span> <span style="color:#57c7ff">ggplot</span>(data <span style="color:#ff6ac1">=</span> .x, <span style="color:#57c7ff">aes</span>(
        x <span style="color:#ff6ac1">=</span> pct, y <span style="color:#ff6ac1">=</span> thing, fill <span style="color:#ff6ac1">=</span> thing
      )) <span style="color:#ff6ac1">+</span>
        <span style="color:#57c7ff">ggtitle</span>(<span style="color:#57c7ff">glue</span>(<span style="color:#5af78e">&#34;{.y}&#34;</span>)) <span style="color:#ff6ac1">+</span>
        <span style="color:#57c7ff">geom_col</span>() <span style="color:#ff6ac1">+</span>
        <span style="color:#57c7ff">scale_x_continuous</span>(labels <span style="color:#ff6ac1">=</span> scales<span style="color:#ff6ac1">::</span><span style="color:#57c7ff">percent_format</span>(accuracy <span style="color:#ff6ac1">=</span> <span style="color:#ff9f43">1</span>)) <span style="color:#ff6ac1">+</span>
        my_theme <span style="color:#ff6ac1">+</span>
        <span style="color:#57c7ff">theme</span>(axis.title.y <span style="color:#ff6ac1">=</span> <span style="color:#57c7ff">element_blank</span>(),
              axis.title.x <span style="color:#ff6ac1">=</span> <span style="color:#57c7ff">element_blank</span>(),
              plot.title <span style="color:#ff6ac1">=</span> <span style="color:#57c7ff">element_text</span>(size <span style="color:#ff6ac1">=</span> <span style="color:#ff9f43">12</span>))
    )
  )
</code></pre></div><pre><code>## # A tibble: 6 × 3
##   item                                   data plot  
##   &lt;chr&gt;                    &lt;list&lt;tibble[,3]&gt;&gt; &lt;list&gt;
## 1 Business Travel                     [3 × 3] &lt;gg&gt;  
## 2 Department                          [3 × 3] &lt;gg&gt;  
## 3 Education                           [5 × 3] &lt;gg&gt;  
## 4 Education Field                     [6 × 3] &lt;gg&gt;  
## 5 Environment Satisfaction            [5 × 3] &lt;gg&gt;  
## 6 Gender                              [2 × 3] &lt;gg&gt;
</code></pre>
<p>I’m using ggarrange so that I can lay them out in a grid and make them the same size using horizontal + vertical alignment. Thankfully ggarrange already has a plotlist argument, so I don’t have to write out every plot in the list separately.</p>
<p>Note: If you don’t want NAs in your charts, you can replace them using fct_explicit_na from the forcats package.</p>
<p>Speaking of variables, here are some more related posts from Ask a Manager:</p>
<ul>
<li>If your company has a <a href="https://www.askamanager.org/2021/06/my-companys-leadership-programs-for-women-excludes-men.html">leadership training program for women</a>, try not to be a jerk about it</li>
<li>Speaking of marital status, what happens when your <a href="https://www.askamanager.org/2018/05/my-dad-is-dating-my-boss-and-they-want-me-to-go-to-couples-therapy-with-them.html">dad is dating your boss and they want you to go to couples therapy with them</a>?</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">ggpubr<span style="color:#ff6ac1">::</span><span style="color:#57c7ff">ggarrange</span>(
  plotlist <span style="color:#ff6ac1">=</span> plot_data<span style="color:#ff6ac1">$</span>plot,
  nrow <span style="color:#ff6ac1">=</span> <span style="color:#ff9f43">4</span>,
  ncol <span style="color:#ff6ac1">=</span> <span style="color:#ff9f43">3</span>,
  align <span style="color:#ff6ac1">=</span> <span style="color:#5af78e">&#39;hv&#39;</span>
)
</code></pre></div><p><img src="https://kpress.dev/post/2021-06-21-the-office-part-i/index.en-us_files/figure-html/unnamed-chunk-18-1.png" width="1152" style="display: block; margin: auto;" /></p>
<h2 id="ridgeline-charts">Ridgeline Charts</h2>
<p>I would like to visualize how some of the variables interact with each other. Ridgeline charts can be a good way to do that, and they look pretty cool.</p>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#57c7ff">ggplot</span>(data, <span style="color:#57c7ff">aes</span>(x <span style="color:#ff6ac1">=</span> monthly_income, y<span style="color:#ff6ac1">=</span> job_role, fill <span style="color:#ff6ac1">=</span> job_role))<span style="color:#ff6ac1">+</span>
  <span style="color:#57c7ff">geom_density_ridges</span>()<span style="color:#ff6ac1">+</span>
  <span style="color:#57c7ff">scale_x_continuous</span>(name <span style="color:#ff6ac1">=</span> <span style="color:#5af78e">&#34;Monthly Income&#34;</span>, labels <span style="color:#ff6ac1">=</span> scales<span style="color:#ff6ac1">::</span>dollar)<span style="color:#ff6ac1">+</span>
  <span style="color:#57c7ff">ggtitle</span>(<span style="color:#5af78e">&#34;Monthly Income by Job Role&#34;</span>)<span style="color:#ff6ac1">+</span>
  my_theme<span style="color:#ff6ac1">+</span>
  <span style="color:#57c7ff">theme</span>(axis.title.y <span style="color:#ff6ac1">=</span> <span style="color:#57c7ff">element_blank</span>())
</code></pre></div><p><img src="https://kpress.dev/post/2021-06-21-the-office-part-i/index.en-us_files/figure-html/unnamed-chunk-19-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>By level of education:</p>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#57c7ff">ggplot</span>(data, <span style="color:#57c7ff">aes</span>(x <span style="color:#ff6ac1">=</span> monthly_income, y<span style="color:#ff6ac1">=</span> education_2, fill <span style="color:#ff6ac1">=</span> education_2))<span style="color:#ff6ac1">+</span>
  <span style="color:#57c7ff">geom_density_ridges</span>()<span style="color:#ff6ac1">+</span>
  <span style="color:#57c7ff">scale_x_continuous</span>(name <span style="color:#ff6ac1">=</span> <span style="color:#5af78e">&#34;Monthly Income&#34;</span>, labels <span style="color:#ff6ac1">=</span> scales<span style="color:#ff6ac1">::</span>dollar)<span style="color:#ff6ac1">+</span>
  <span style="color:#57c7ff">ggtitle</span>(<span style="color:#5af78e">&#34;Monthly Income by Education Level&#34;</span>)<span style="color:#ff6ac1">+</span>
  my_theme<span style="color:#ff6ac1">+</span>
  <span style="color:#57c7ff">theme</span>(axis.title.y <span style="color:#ff6ac1">=</span> <span style="color:#57c7ff">element_blank</span>())
</code></pre></div><p><img src="https://kpress.dev/post/2021-06-21-the-office-part-i/index.en-us_files/figure-html/unnamed-chunk-20-1.png" width="768" style="display: block; margin: auto;" /></p>
<h1 id="creating-the-models">Creating the Models</h1>
<p>Now that I’ve cleaned up and explored the data a little bit, it’s time to start the modeling process.</p>
<h3 id="creating-variable-groups">Creating Variable Groups</h3>
<p>To create my “truth table” for all possible combinations of variables to model, I need to group my variables into categories. Some of these probably could be grouped in different ways, but this is just for demonstration purposes so it doesn’t have to be perfect. I’m wrapping all the groups in the crossing() function from tidyr, which will expand these lists to all possible combinations of the different variable groups.</p>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">cross_df <span style="color:#ff6ac1">&lt;-</span> <span style="color:#57c7ff">crossing</span>(
    age <span style="color:#ff6ac1">=</span> <span style="color:#57c7ff">c</span>(<span style="color:#5af78e">&#34;age&#34;</span>, <span style="color:#5af78e">&#34;total_working_years&#34;</span>, <span style="color:#5af78e">&#34;num_companies_worked&#34;</span>),
    demos <span style="color:#ff6ac1">=</span> <span style="color:#57c7ff">c</span>(<span style="color:#5af78e">&#34;gender&#34;</span>, <span style="color:#5af78e">&#34;marital_status&#34;</span>),
    company_time <span style="color:#ff6ac1">=</span> <span style="color:#57c7ff">c</span>(
      <span style="color:#5af78e">&#34;years_at_company&#34;</span>,
      <span style="color:#5af78e">&#34;years_since_last_promotion&#34;</span>,
      <span style="color:#5af78e">&#34;years_with_curr_manager&#34;</span>
    ),
    work_life_balance <span style="color:#ff6ac1">=</span> <span style="color:#57c7ff">c</span>(
      <span style="color:#5af78e">&#34;distance_from_home&#34;</span>,
      <span style="color:#5af78e">&#34;business_travel&#34;</span>,
      <span style="color:#5af78e">&#34;work_life_balance&#34;</span>,
      <span style="color:#5af78e">&#34;avg_weekly_hours&#34;</span>
    ),
    level <span style="color:#ff6ac1">=</span> <span style="color:#57c7ff">c</span>(
      <span style="color:#5af78e">&#34;education&#34;</span>,
      <span style="color:#5af78e">&#34;job_level&#34;</span>,
      <span style="color:#5af78e">&#34;monthly_income&#34;</span>,
      <span style="color:#5af78e">&#34;stock_option_level&#34;</span>
    ),
    work_type <span style="color:#ff6ac1">=</span> <span style="color:#57c7ff">c</span>(<span style="color:#5af78e">&#34;education_field&#34;</span>, <span style="color:#5af78e">&#34;department&#34;</span>, <span style="color:#5af78e">&#34;job_role&#34;</span>),
    performance <span style="color:#ff6ac1">=</span> <span style="color:#57c7ff">c</span>(
      <span style="color:#5af78e">&#34;performance_rating&#34;</span>,
      <span style="color:#5af78e">&#34;training_times_last_year&#34;</span>,
      <span style="color:#5af78e">&#34;percent_salary_hike&#34;</span>
    ),
    satisfaction <span style="color:#ff6ac1">=</span> <span style="color:#57c7ff">c</span>(<span style="color:#5af78e">&#34;environment_satisfaction&#34;</span>, <span style="color:#5af78e">&#34;job_satisfaction&#34;</span>)
  )
</code></pre></div><p>This is what the resulting tibble looks like. There are 5,184 different possible model combinations.</p>
<div id="htmlwidget-5" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-5">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"age":["age","age","age","age","age","age"],"demos":["gender","gender","gender","gender","gender","gender"],"company_time":["years_at_company","years_at_company","years_at_company","years_at_company","years_at_company","years_at_company"],"work_life_balance":["avg_weekly_hours","avg_weekly_hours","avg_weekly_hours","avg_weekly_hours","avg_weekly_hours","avg_weekly_hours"],"level":["education","education","education","education","education","education"],"work_type":["department","department","department","department","department","department"],"performance":["percent_salary_hike","percent_salary_hike","performance_rating","performance_rating","training_times_last_year","training_times_last_year"],"satisfaction":["environment_satisfaction","job_satisfaction","environment_satisfaction","job_satisfaction","environment_satisfaction","job_satisfaction"]},"columns":[{"accessor":"age","name":"age","type":"character"},{"accessor":"demos","name":"demos","type":"character"},{"accessor":"company_time","name":"company_time","type":"character"},{"accessor":"work_life_balance","name":"work_life_balance","type":"character"},{"accessor":"level","name":"level","type":"character"},{"accessor":"work_type","name":"work_type","type":"character"},{"accessor":"performance","name":"performance","type":"character"},{"accessor":"satisfaction","name":"satisfaction","type":"character"}],"defaultPageSize":10,"paginationType":"numbers","showPageInfo":true,"minRows":1,"highlight":true,"bordered":true,"striped":true,"compact":true,"nowrap":true,"dataKey":"a383ebf86cb42f1395de98adf3b6c9c6","key":"a383ebf86cb42f1395de98adf3b6c9c6"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<h3 id="creating-formulas">Creating Formulas</h3>
<p>Now I have variables I need for the model but they’re all in different columns. I need to make it look more like the formula I’m going to use. To do that, I can use unite (also from tidyr). I’ll combine columns 1 through 8 into a new column called “formula,” separated by the plus sign because that’s the syntax the model will need as an input.</p>
<p>Then I paste the outcome variable (attrition_2) in front of the formula, just like it would be in a glm model. Add a model name to help keep track of everything later on.</p>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">formula_df <span style="color:#ff6ac1">&lt;-</span> cross_df <span style="color:#ff6ac1">%&gt;%</span> 
  <span style="color:#57c7ff">unite</span>(formula, <span style="color:#57c7ff">c</span>(<span style="color:#ff9f43">1</span><span style="color:#ff6ac1">:</span><span style="color:#ff9f43">8</span>), sep <span style="color:#ff6ac1">=</span> <span style="color:#5af78e">&#34;+&#34;</span>) <span style="color:#ff6ac1">%&gt;%</span> 
  <span style="color:#57c7ff">select</span>(formula) <span style="color:#ff6ac1">%&gt;%</span> 
  <span style="color:#57c7ff">mutate</span>(formula <span style="color:#ff6ac1">=</span> <span style="color:#57c7ff">paste0</span>(<span style="color:#5af78e">&#34;attrition_2 ~ &#34;</span>, formula)) <span style="color:#ff6ac1">%&gt;%</span> 
  <span style="color:#57c7ff">mutate</span>(model_name <span style="color:#ff6ac1">=</span> <span style="color:#57c7ff">row_number</span>())
</code></pre></div><p>This is what the formula looks like</p>
<div id="htmlwidget-6" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-6">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"formula":["attrition_2 ~ age+gender+years_at_company+avg_weekly_hours+education+department+percent_salary_hike+environment_satisfaction","attrition_2 ~ age+gender+years_at_company+avg_weekly_hours+education+department+percent_salary_hike+job_satisfaction","attrition_2 ~ age+gender+years_at_company+avg_weekly_hours+education+department+performance_rating+environment_satisfaction","attrition_2 ~ age+gender+years_at_company+avg_weekly_hours+education+department+performance_rating+job_satisfaction","attrition_2 ~ age+gender+years_at_company+avg_weekly_hours+education+department+training_times_last_year+environment_satisfaction","attrition_2 ~ age+gender+years_at_company+avg_weekly_hours+education+department+training_times_last_year+job_satisfaction"],"model_name":[1,2,3,4,5,6]},"columns":[{"accessor":"formula","name":"formula","type":"character"},{"accessor":"model_name","name":"model_name","type":"numeric"}],"defaultPageSize":10,"paginationType":"numbers","showPageInfo":true,"minRows":1,"highlight":true,"bordered":true,"striped":true,"compact":true,"nowrap":true,"dataKey":"c0638114d46e1ab1b56db320404d2219","key":"c0638114d46e1ab1b56db320404d2219"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<p>First I will create a function that I can map over my dataset of formulas. This is just a regular binomial logistic regression model.</p>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">mod_fun <span style="color:#ff6ac1">&lt;-</span> <span style="color:#57c7ff">function</span>(x) {<span style="color:#57c7ff">glm</span>(formula <span style="color:#ff6ac1">=</span> <span style="color:#57c7ff">as.formula</span>(x), family <span style="color:#ff6ac1">=</span> <span style="color:#57c7ff">binomial</span>(<span style="color:#5af78e">&#34;logit&#34;</span>), data <span style="color:#ff6ac1">=</span> data)}
</code></pre></div><h3 id="mapping-the-models">Mapping the Models</h3>
<p>Now map over the models. WARNING - this will take a minute. It’s a bit faster if you don’t ask for the odds ratios (exponentiated coefficients). If you have a very large dataset, you’re going to want to test this on just a couple of your formulas to make sure you’ve got everything set up right. If you have a really, really large dataset, you can always run it in batches as well. What this does is:</p>
<ul>
<li>Map over each cell in the formula column using the formula I created</li>
<li>Using the broom package, create a new tidied column for the model summary and model fit</li>
<li>Unnest the model summary and fit info into a tidied dataframe</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">model_df <span style="color:#ff6ac1">&lt;-</span> formula_df <span style="color:#ff6ac1">%&gt;%</span> 
  <span style="color:#57c7ff">mutate</span>(models <span style="color:#ff6ac1">=</span> <span style="color:#57c7ff">map</span>(formula, mod_fun), 
         model_summary <span style="color:#ff6ac1">=</span> models <span style="color:#ff6ac1">%&gt;%</span> <span style="color:#57c7ff">map</span>(<span style="color:#ff6ac1">~</span><span style="color:#57c7ff">tidy</span>(., exponentiate <span style="color:#ff6ac1">=</span> <span style="color:#ff6ac1">TRUE</span>)), 
         model_fit <span style="color:#ff6ac1">=</span> models <span style="color:#ff6ac1">%&gt;%</span> <span style="color:#57c7ff">map</span>(glance)) <span style="color:#ff6ac1">%&gt;%</span>
  <span style="color:#57c7ff">select</span>(model_name, model_summary, model_fit) <span style="color:#ff6ac1">%&gt;%</span>
  <span style="color:#57c7ff">unnest</span>(<span style="color:#57c7ff">c</span>(model_summary, model_fit)) <span style="color:#ff6ac1">%&gt;%</span>
  <span style="color:#57c7ff">mutate_if</span>(is.numeric, <span style="color:#ff6ac1">~</span> <span style="color:#57c7ff">round</span>(., <span style="color:#ff9f43">3</span>))
</code></pre></div><h2 id="filtering-model-data">Filtering Model Data</h2>
<p>Now I have a tidy dataset of all the models of all possible combinations of variables in my pre-defined groups. I can filter based on whatever criteria is most important.</p>
<h3 id="lowest-aic">Lowest AIC</h3>
<p>For example, here is the model with the lowest AIC:</p>
<div id="htmlwidget-7" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-7">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"model_name":[4925,4925,4925,4925,4925,4925],"term":["(Intercept)","total_working_years","marital_statusMarried","marital_statusSingle","years_with_curr_manager","avg_weekly_hours"],"estimate":[0.113,0.948,1.323,3.133,0.914,1.093],"std.error":[0.397,0.008,0.133,0.131,0.016,0.007],"statistic":[-5.496,-6.88,2.101,8.694,-5.496,13.134],"p.value":[0,0,0.036,0,0,0],"null.deviance":[3860.701,3860.701,3860.701,3860.701,3860.701,3860.701],"df.null":[4375,4375,4375,4375,4375,4375],"logLik":[-1651.434,-1651.434,-1651.434,-1651.434,-1651.434,-1651.434],"AIC":[3330.869,3330.869,3330.869,3330.869,3330.869,3330.869],"BIC":[3420.243,3420.243,3420.243,3420.243,3420.243,3420.243],"deviance":[3302.869,3302.869,3302.869,3302.869,3302.869,3302.869],"df.residual":[4362,4362,4362,4362,4362,4362],"nobs":[4376,4376,4376,4376,4376,4376]},"columns":[{"accessor":"model_name","name":"model_name","type":"numeric"},{"accessor":"term","name":"term","type":"character"},{"accessor":"estimate","name":"estimate","type":"numeric"},{"accessor":"std.error","name":"std.error","type":"numeric"},{"accessor":"statistic","name":"statistic","type":"numeric"},{"accessor":"p.value","name":"p.value","type":"numeric"},{"accessor":"null.deviance","name":"null.deviance","type":"numeric"},{"accessor":"df.null","name":"df.null","type":"numeric"},{"accessor":"logLik","name":"logLik","type":"numeric"},{"accessor":"AIC","name":"AIC","type":"numeric"},{"accessor":"BIC","name":"BIC","type":"numeric"},{"accessor":"deviance","name":"deviance","type":"numeric"},{"accessor":"df.residual","name":"df.residual","type":"numeric"},{"accessor":"nobs","name":"nobs","type":"numeric"}],"defaultPageSize":10,"paginationType":"numbers","showPageInfo":true,"minRows":1,"highlight":true,"bordered":true,"striped":true,"compact":true,"nowrap":true,"dataKey":"e8dce4c8b83f08f72089361796e61465","key":"e8dce4c8b83f08f72089361796e61465"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<h3 id="all-significant-variables">All Significant Variables</h3>
<p>Or I could look for models where every variable is statistically significant, or filter to ensure that the model contains one variable I’m particularly interested in.</p>
<div id="htmlwidget-8" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-8">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"model_name":[869,869,869,869,869,869],"term":["(Intercept)","age","marital_statusMarried","marital_statusSingle","years_at_company","avg_weekly_hours"],"estimate":[0.231,0.961,1.277,2.964,0.947,1.094],"std.error":[0.406,0.005,0.132,0.131,0.01,0.007],"statistic":[-3.611,-7.336,1.848,8.326,-5.555,13.328],"p.value":[0,0,0.065,0,0,0],"null.deviance":[3870.464,3870.464,3870.464,3870.464,3870.464,3870.464],"df.null":[4384,4384,4384,4384,4384,4384],"logLik":[-1671.859,-1671.859,-1671.859,-1671.859,-1671.859,-1671.859],"AIC":[3365.718,3365.718,3365.718,3365.718,3365.718,3365.718],"BIC":[3435.964,3435.964,3435.964,3435.964,3435.964,3435.964],"deviance":[3343.718,3343.718,3343.718,3343.718,3343.718,3343.718],"df.residual":[4374,4374,4374,4374,4374,4374],"nobs":[4385,4385,4385,4385,4385,4385]},"columns":[{"accessor":"model_name","name":"model_name","type":"numeric"},{"accessor":"term","name":"term","type":"character"},{"accessor":"estimate","name":"estimate","type":"numeric"},{"accessor":"std.error","name":"std.error","type":"numeric"},{"accessor":"statistic","name":"statistic","type":"numeric"},{"accessor":"p.value","name":"p.value","type":"numeric"},{"accessor":"null.deviance","name":"null.deviance","type":"numeric"},{"accessor":"df.null","name":"df.null","type":"numeric"},{"accessor":"logLik","name":"logLik","type":"numeric"},{"accessor":"AIC","name":"AIC","type":"numeric"},{"accessor":"BIC","name":"BIC","type":"numeric"},{"accessor":"deviance","name":"deviance","type":"numeric"},{"accessor":"df.residual","name":"df.residual","type":"numeric"},{"accessor":"nobs","name":"nobs","type":"numeric"}],"defaultPageSize":10,"paginationType":"numbers","showPageInfo":true,"minRows":1,"highlight":true,"bordered":true,"striped":true,"compact":true,"nowrap":true,"dataKey":"de10cb6bd76212dad5ce23dc13dec461","key":"de10cb6bd76212dad5ce23dc13dec461"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<h3 id="significance-of-terms-across-models">Significance of Terms Across Models</h3>
<p>I could look at how many times a particular term was considered significant across all models. It looks like environment satisfaction, job satisfaction, marital status, age,department, and education field are all near the top of the list. However, stock option level, gender, and a few of the job roles were not significant in many of the models (if at all).</p>
<div id="htmlwidget-9" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-9">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"term":["(Intercept)","environment_satisfaction","job_satisfaction","marital_statusSingle","age","departmentResearch & Development","departmentSales","education_fieldLife Sciences","education_fieldMarketing","education_fieldMedical","education_fieldOther","education_fieldTechnical Degree","total_working_years","training_times_last_year","years_with_curr_manager","years_at_company","job_roleResearch Director","avg_weekly_hours","business_travelTravel Frequently","business_travelTravel Rarely","work_life_balance","num_companies_worked","marital_statusMarried","percent_salary_hike","years_since_last_promotion","monthly_income","performance_rating","job_roleResearch Scientist","job_roleManufacturing Director","education","job_roleSales Executive","job_level","distance_from_home","genderMale","job_roleHuman Resources","job_roleLaboratory Technician","job_roleManager","job_roleSales Representative","stock_option_level"],"num_significant":[3394,2592,2592,2592,1728,1728,1728,1728,1728,1728,1728,1728,1728,1728,1728,1691,1598,1296,1296,1296,1296,1193,1039,676,610,481,130,97,88,15,8,5,0,0,0,0,0,0,0]},"columns":[{"accessor":"term","name":"term","type":"character"},{"accessor":"num_significant","name":"num_significant","type":"numeric"}],"defaultPageSize":10,"paginationType":"numbers","showPageInfo":true,"minRows":1,"highlight":true,"bordered":true,"striped":true,"compact":true,"nowrap":true,"dataKey":"654350796f1ad84a7f3d94e800218f2c","key":"654350796f1ad84a7f3d94e800218f2c"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<h3 id="odds-ratios-of-significant-terms-across-models">Odds Ratios of Significant Terms Across Models</h3>
<p>I can also look at the statistically significant terms to see how their odds ratios differ across the models.</p>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">plot2 <span style="color:#ff6ac1">&lt;-</span> model_df <span style="color:#ff6ac1">%&gt;%</span> 
  <span style="color:#57c7ff">filter</span>(<span style="color:#ff6ac1">!</span><span style="color:#57c7ff">str_detect</span>(term, <span style="color:#5af78e">&#34;Intercept&#34;</span>), p.value <span style="color:#ff6ac1">&lt;</span> <span style="color:#ff9f43">.01</span>) <span style="color:#ff6ac1">%&gt;%</span> 
  <span style="color:#57c7ff">count</span>(term, estimate) <span style="color:#ff6ac1">%&gt;%</span> 
  <span style="color:#57c7ff">mutate</span>(term <span style="color:#ff6ac1">=</span> <span style="color:#57c7ff">str_to_sentence</span>(<span style="color:#57c7ff">str_replace_all</span>(term, <span style="color:#5af78e">&#34;_&#34;</span>, <span style="color:#5af78e">&#34; &#34;</span>))) <span style="color:#ff6ac1">%&gt;%</span> 
  <span style="color:#57c7ff">filter</span>(estimate <span style="color:#ff6ac1">!=</span> <span style="color:#ff9f43">0</span>, <span style="color:#ff6ac1">!</span><span style="color:#57c7ff">str_detect</span>(term, <span style="color:#5af78e">&#34;income&#34;</span>)) <span style="color:#ff6ac1">%&gt;%</span> 
  <span style="color:#57c7ff">mutate</span>(term <span style="color:#ff6ac1">=</span> <span style="color:#57c7ff">str_replace_all</span>(term, <span style="color:#5af78e">&#34;Marital status&#34;</span>, <span style="color:#5af78e">&#34;Marital status: &#34;</span>),
         term <span style="color:#ff6ac1">=</span> <span style="color:#57c7ff">str_replace_all</span>(term, <span style="color:#5af78e">&#34;Job role&#34;</span>, <span style="color:#5af78e">&#34;Job role: &#34;</span>),
         term <span style="color:#ff6ac1">=</span> <span style="color:#57c7ff">str_replace_all</span>(term, <span style="color:#5af78e">&#34;Education field&#34;</span>, <span style="color:#5af78e">&#34;Field: &#34;</span>),
         term <span style="color:#ff6ac1">=</span> <span style="color:#57c7ff">str_replace_all</span>(term, <span style="color:#5af78e">&#34;Department&#34;</span>, <span style="color:#5af78e">&#34;Dept: &#34;</span>),
         term <span style="color:#ff6ac1">=</span> <span style="color:#57c7ff">str_replace_all</span>(term, <span style="color:#5af78e">&#34;Business travel&#34;</span>, <span style="color:#5af78e">&#34;Travel: &#34;</span>))

<span style="color:#57c7ff">ggplot</span>(plot2, <span style="color:#57c7ff">aes</span>(x <span style="color:#ff6ac1">=</span> estimate, y <span style="color:#ff6ac1">=</span> term, fill <span style="color:#ff6ac1">=</span> term)) <span style="color:#ff6ac1">+</span>
  <span style="color:#57c7ff">geom_density_ridges</span>(scale <span style="color:#ff6ac1">=</span> <span style="color:#ff9f43">2</span>
) <span style="color:#ff6ac1">+</span>
  <span style="color:#57c7ff">theme_ridges</span>() <span style="color:#ff6ac1">+</span> 
  <span style="color:#57c7ff">scale_x_continuous</span>(name <span style="color:#ff6ac1">=</span> <span style="color:#5af78e">&#34;Odds Ratio&#34;</span>)<span style="color:#ff6ac1">+</span>
  <span style="color:#57c7ff">theme</span>(legend.position <span style="color:#ff6ac1">=</span> <span style="color:#5af78e">&#34;none&#34;</span>)<span style="color:#ff6ac1">+</span>
  <span style="color:#57c7ff">ggtitle</span>(<span style="color:#5af78e">&#34;Likelihood of Attrition&#34;</span>, subtitle <span style="color:#ff6ac1">=</span> <span style="color:#5af78e">&#34;by Significant Terms Across All Models&#34;</span>)<span style="color:#ff6ac1">+</span>
  my_theme<span style="color:#ff6ac1">+</span>
  <span style="color:#57c7ff">theme</span>(axis.title.y <span style="color:#ff6ac1">=</span> <span style="color:#57c7ff">element_blank</span>(),
        axis.title.x <span style="color:#ff6ac1">=</span> <span style="color:#57c7ff">element_text</span>(family <span style="color:#ff6ac1">=</span> <span style="color:#5af78e">&#34;Arial&#34;</span>, hjust <span style="color:#ff6ac1">=</span> <span style="color:#ff9f43">.5</span>))
</code></pre></div><p><img src="https://kpress.dev/post/2021-06-21-the-office-part-i/index.en-us_files/figure-html/unnamed-chunk-31-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>It looks like people who travel frequently have some of the highest odds ratios, which means they are more likely to leave their jobs. People who travel rarely are also likely to leave - in comparison to those who don’t travel at all. Single people and research directors also have high likelihoods of leaving. These four variables also seem to vary the most in terms of the odds ratio across all models. For example the lowest odds ratio for marital status: single was around 2.6 and the highest was around 3.4.</p>
<p>Average weekly hours, number of companies worked for, and years since last promotion all had a slightly higher likelihood of leaving, and their odds ratios were quite similar across all models. The lowest odds ratio for average weekly hours was 1.08, and the highest was 1.096.</p>
<p>Some variables are associated with lower likelihood of leaving, for example age (older) and years at the company, some education fields and job roles.</p>
<h3 id="selecting-a-final-model">Selecting a Final Model</h3>
<p>I could use the information in the previous chart to filter down and select a final model. For example, I might want to ensure that the travel variable is included, along with marital status. And make sure they are both significant in whatever models I bring up. This set of filtering criteria gives me 648 models to choose from.</p>
<p>Speaking of marital status, there are so many good spouse-related posts.</p>
<ul>
<li>A <a href="https://www.askamanager.org/2020/08/job-candidates-suspicious-husband-photographed-me-before-her-interview.html">job candidate’s suspicious husband</a> photographs her interviewer</li>
<li>When you <a href="https://www.askamanager.org/2019/11/ive-been-accidentally-dating-my-bosss-husband.html">accidentally start dating your new boss’s husband</a></li>
</ul>
<p>And speaking of travel, this is one of my favorite posts ever - this poor woman got in trouble for what she was wearing <a href="https://www.askamanager.org/2016/11/im-in-trouble-for-what-i-wore-when-when-my-boss-made-me-pick-him-up-for-the-airport-in-the-middle-of-the-night.html">when her boss made her pick him up in the middle of the night</a>. Just… wtf?</p>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">temp_models <span style="color:#ff6ac1">&lt;-</span> model_df <span style="color:#ff6ac1">%&gt;%</span> 
  <span style="color:#57c7ff">group_by</span>(model_name) <span style="color:#ff6ac1">%&gt;%</span> 
  <span style="color:#57c7ff">filter</span>(<span style="color:#57c7ff">any</span>(<span style="color:#57c7ff">str_detect</span>(term, <span style="color:#5af78e">&#34;travel&#34;</span>) <span style="color:#ff6ac1">&amp;</span> p.value <span style="color:#ff6ac1">&lt;</span> <span style="color:#ff9f43">.05</span>), <span style="color:#57c7ff">any</span>(<span style="color:#57c7ff">str_detect</span>(term, <span style="color:#5af78e">&#34;marital&#34;</span>) <span style="color:#ff6ac1">&amp;</span> p.value <span style="color:#ff6ac1">&lt;</span> <span style="color:#ff9f43">.05</span>))

<span style="color:#57c7ff">distinct</span>(temp_models, model_name) <span style="color:#ff6ac1">%&gt;%</span> <span style="color:#57c7ff">nrow</span>()
</code></pre></div><pre><code>## [1] 648
</code></pre>
<p>That’s still probably too many, so I’ll add a filter for education field as well, since there are several fields that are less likely to leave. Now there are “only” 216 models.</p>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">temp_models <span style="color:#ff6ac1">&lt;-</span> temp_models <span style="color:#ff6ac1">%&gt;%</span> 
  <span style="color:#57c7ff">group_by</span>(model_name) <span style="color:#ff6ac1">%&gt;%</span> 
  <span style="color:#57c7ff">filter</span>(<span style="color:#57c7ff">any</span>(<span style="color:#57c7ff">str_detect</span>(term, <span style="color:#5af78e">&#34;field&#34;</span>) <span style="color:#ff6ac1">&amp;</span> p.value <span style="color:#ff6ac1">&lt;</span> <span style="color:#ff9f43">.05</span>))

<span style="color:#57c7ff">distinct</span>(temp_models, model_name) <span style="color:#ff6ac1">%&gt;%</span> <span style="color:#57c7ff">nrow</span>()
</code></pre></div><pre><code>## [1] 216
</code></pre>
<p>You know what they say, people don’t quit a job they quit a boss. Especially if they have one of the <a href="https://www.askamanager.org/2020/12/the-worst-boss-of-2020-is.html">worst bosses of 2020</a>. Let’s also keep the years with current manager and job satisfaction variables. Down to only 36 models.</p>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">temp_models <span style="color:#ff6ac1">&lt;-</span> temp_models <span style="color:#ff6ac1">%&gt;%</span> 
  <span style="color:#57c7ff">group_by</span>(model_name) <span style="color:#ff6ac1">%&gt;%</span> 
  <span style="color:#57c7ff">filter</span>(<span style="color:#57c7ff">any</span>(<span style="color:#57c7ff">str_detect</span>(term, <span style="color:#5af78e">&#34;job_sat&#34;</span>) <span style="color:#ff6ac1">&amp;</span> p.value <span style="color:#ff6ac1">&lt;</span> <span style="color:#ff9f43">.05</span>), <span style="color:#57c7ff">any</span>(<span style="color:#57c7ff">str_detect</span>(term, <span style="color:#5af78e">&#34;manager&#34;</span>) <span style="color:#ff6ac1">&amp;</span> p.value <span style="color:#ff6ac1">&lt;</span> <span style="color:#ff9f43">.05</span>))

<span style="color:#57c7ff">distinct</span>(temp_models, model_name) <span style="color:#ff6ac1">%&gt;%</span> <span style="color:#57c7ff">nrow</span>()
</code></pre></div><pre><code>## [1] 36
</code></pre>
<p>It looks like model 4998 is the winner with the lowest AIC out of those 36. All of the variables are significant except for job_level, which is probably fine.</p>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">temp_models <span style="color:#ff6ac1">&lt;-</span> temp_models <span style="color:#ff6ac1">%&gt;%</span> 
  <span style="color:#57c7ff">ungroup</span>() <span style="color:#ff6ac1">%&gt;%</span> 
  <span style="color:#57c7ff">filter</span>(AIC <span style="color:#ff6ac1">==</span> <span style="color:#57c7ff">min</span>(AIC))
</code></pre></div><div id="htmlwidget-10" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-10">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"model_name":[4998,4998,4998,4998,4998,4998],"term":["(Intercept)","total_working_years","marital_statusMarried","marital_statusSingle","years_with_curr_manager","business_travelTravel Frequently"],"estimate":[1.445,0.948,1.268,2.834,0.911,3.931],"std.error":[0.365,0.008,0.13,0.128,0.016,0.198],"statistic":[1.007,-6.895,1.828,8.138,-5.741,6.899],"p.value":[0.314,0,0.067,0,0,0],"null.deviance":[3875.651,3875.651,3875.651,3875.651,3875.651,3875.651],"df.null":[4380,4380,4380,4380,4380,4380],"logLik":[-1706.42,-1706.42,-1706.42,-1706.42,-1706.42,-1706.42],"AIC":[3442.839,3442.839,3442.839,3442.839,3442.839,3442.839],"BIC":[3538.615,3538.615,3538.615,3538.615,3538.615,3538.615],"deviance":[3412.839,3412.839,3412.839,3412.839,3412.839,3412.839],"df.residual":[4366,4366,4366,4366,4366,4366],"nobs":[4381,4381,4381,4381,4381,4381]},"columns":[{"accessor":"model_name","name":"model_name","type":"numeric"},{"accessor":"term","name":"term","type":"character"},{"accessor":"estimate","name":"estimate","type":"numeric"},{"accessor":"std.error","name":"std.error","type":"numeric"},{"accessor":"statistic","name":"statistic","type":"numeric"},{"accessor":"p.value","name":"p.value","type":"numeric"},{"accessor":"null.deviance","name":"null.deviance","type":"numeric"},{"accessor":"df.null","name":"df.null","type":"numeric"},{"accessor":"logLik","name":"logLik","type":"numeric"},{"accessor":"AIC","name":"AIC","type":"numeric"},{"accessor":"BIC","name":"BIC","type":"numeric"},{"accessor":"deviance","name":"deviance","type":"numeric"},{"accessor":"df.residual","name":"df.residual","type":"numeric"},{"accessor":"nobs","name":"nobs","type":"numeric"}],"defaultPageSize":10,"paginationType":"numbers","showPageInfo":true,"minRows":1,"highlight":true,"bordered":true,"striped":true,"compact":true,"nowrap":true,"dataKey":"5032e306a97f3f9d43d37bd9cfd546bf","key":"5032e306a97f3f9d43d37bd9cfd546bf"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<h1 id="using-the-model">Using the Model</h1>
<p>What to do with the information from all these models? Some companies actually use predictive models that spy on their employees’ work computers and monitor their emails and LinkedIn activity to try and figure out who is thinking about leaving. What they do with this information may or may not be good (like a retention bonus), but it’s still creepy either way. I could create a sort of “attrition score” using the variables in this model.</p>
<h2 id="item-analysis">Item Analysis</h2>
<p>Create some scores for each item in the model. Here I’ll write a little function to tell me the proportion of staff who left for each variable so I don’t have to copy and paste so much.</p>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">tbl_att <span style="color:#ff6ac1">&lt;-</span> <span style="color:#57c7ff">function</span>(df, col){
  col <span style="color:#ff6ac1">&lt;-</span> <span style="color:#57c7ff">enquo</span>(col)
  
  df <span style="color:#ff6ac1">%&gt;%</span> 
    <span style="color:#57c7ff">count</span>(<span style="color:#ff6ac1">!!</span>col, attrition) <span style="color:#ff6ac1">%&gt;%</span> 
    <span style="color:#57c7ff">group_by</span>(<span style="color:#ff6ac1">!!</span>col) <span style="color:#ff6ac1">%&gt;%</span> 
    <span style="color:#57c7ff">mutate</span>(pct <span style="color:#ff6ac1">=</span> scales<span style="color:#ff6ac1">::</span><span style="color:#57c7ff">percent</span>(n<span style="color:#ff6ac1">/</span><span style="color:#57c7ff">sum</span>(n), accuracy <span style="color:#ff6ac1">=</span> <span style="color:#ff9f43">.1</span>)) <span style="color:#ff6ac1">%&gt;%</span> 
    <span style="color:#57c7ff">filter</span>(attrition <span style="color:#ff6ac1">==</span> <span style="color:#5af78e">&#34;Yes&#34;</span>)
}
</code></pre></div><h3 id="total-number-of-working-years">Total Number of Working Years</h3>
<p>Looks like people who have worked for 0-1 years total have a high proportion of leavers.</p>
<div id="htmlwidget-11" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-11">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"total_working_years":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,28,31,33,34,40,"NA"],"attrition":["Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes"],"n":[15,119,27,27,36,48,66,54,47,30,75,21,15,9,12,15,9,9,12,9,6,3,6,6,9,3,3,3,3,3,3,6,2],"pct":["45.5%","49.2%","29.0%","21.4%","19.0%","18.2%","17.6%","22.2%","15.3%","10.5%","12.4%","19.8%","10.4%","8.3%","12.9%","12.5%","8.1%","9.1%","14.8%","13.6%","6.7%","2.9%","9.7%","9.1%","16.7%","7.1%","7.1%","7.1%","11.1%","14.3%","20.0%","100.0%","22.2%"]},"columns":[{"accessor":"total_working_years","name":"total_working_years","type":"numeric"},{"accessor":"attrition","name":"attrition","type":"character"},{"accessor":"n","name":"n","type":"numeric"},{"accessor":"pct","name":"pct","type":"character"}],"defaultPageSize":10,"paginationType":"numbers","showPageInfo":true,"minRows":1,"highlight":true,"bordered":true,"striped":true,"compact":true,"nowrap":true,"dataKey":"1746cd1b33aff4d3dbc038a435e3888a","key":"1746cd1b33aff4d3dbc038a435e3888a"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">data <span style="color:#ff6ac1">&lt;-</span> data <span style="color:#ff6ac1">%&gt;%</span> 
  <span style="color:#57c7ff">mutate</span>(total_working_years_score <span style="color:#ff6ac1">=</span> <span style="color:#57c7ff">ifelse</span>(total_working_years <span style="color:#ff6ac1">&lt;</span> <span style="color:#ff9f43">2</span> <span style="color:#ff6ac1">&amp;</span> <span style="color:#ff6ac1">!</span><span style="color:#57c7ff">is.na</span>(total_working_years), <span style="color:#ff9f43">2</span>, <span style="color:#ff9f43">0</span>))
</code></pre></div><div id="htmlwidget-12" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-12">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"total_working_years_score":[0,2],"attrition":["Yes","Yes"],"n":[577,134],"pct":["14.0%","48.7%"]},"columns":[{"accessor":"total_working_years_score","name":"total_working_years_score","type":"numeric"},{"accessor":"attrition","name":"attrition","type":"character"},{"accessor":"n","name":"n","type":"numeric"},{"accessor":"pct","name":"pct","type":"character"}],"defaultPageSize":10,"paginationType":"numbers","showPageInfo":true,"minRows":1,"highlight":true,"bordered":true,"striped":true,"compact":true,"nowrap":true,"dataKey":"692e2ced94eabe6dff4ad3ea39f63364","key":"692e2ced94eabe6dff4ad3ea39f63364"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<h3 id="marital-status">Marital Status</h3>
<p>Single people have the highest proportion of attrition</p>
<div id="htmlwidget-13" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-13">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"marital_status":["Divorced","Married","Single"],"attrition":["Yes","Yes","Yes"],"n":[99,252,360],"pct":["10.1%","12.5%","25.5%"]},"columns":[{"accessor":"marital_status","name":"marital_status","type":"character"},{"accessor":"attrition","name":"attrition","type":"character"},{"accessor":"n","name":"n","type":"numeric"},{"accessor":"pct","name":"pct","type":"character"}],"defaultPageSize":10,"paginationType":"numbers","showPageInfo":true,"minRows":1,"highlight":true,"bordered":true,"striped":true,"compact":true,"nowrap":true,"dataKey":"71b305e7c73661c022723bc4f0da329b","key":"71b305e7c73661c022723bc4f0da329b"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">data <span style="color:#ff6ac1">&lt;-</span> data <span style="color:#ff6ac1">%&gt;%</span> 
  <span style="color:#57c7ff">mutate</span>(marital_status_score <span style="color:#ff6ac1">=</span> <span style="color:#57c7ff">ifelse</span>(marital_status <span style="color:#ff6ac1">==</span> <span style="color:#5af78e">&#34;Single&#34;</span>, <span style="color:#ff9f43">1</span>, <span style="color:#ff9f43">0</span>))
</code></pre></div><div id="htmlwidget-14" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-14">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"marital_status_score":[0,1],"attrition":["Yes","Yes"],"n":[351,360],"pct":["11.7%","25.5%"]},"columns":[{"accessor":"marital_status_score","name":"marital_status_score","type":"numeric"},{"accessor":"attrition","name":"attrition","type":"character"},{"accessor":"n","name":"n","type":"numeric"},{"accessor":"pct","name":"pct","type":"character"}],"defaultPageSize":10,"paginationType":"numbers","showPageInfo":true,"minRows":1,"highlight":true,"bordered":true,"striped":true,"compact":true,"nowrap":true,"dataKey":"cfaee0967d8d97ee1fb0b8c46c6affba","key":"cfaee0967d8d97ee1fb0b8c46c6affba"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<h3 id="years-with-current-manager">Years with Current Manager</h3>
<p>People with new managers (or new-to-them managers) are more likely to leave.</p>
<div id="htmlwidget-15" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-15">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"years_with_curr_manager":[0,1,2,3,4,5,6,7,8,9,10,11,14],"attrition":["Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes"],"n":[255,33,150,57,33,12,12,93,30,18,9,3,6],"pct":["32.3%","14.5%","14.5%","13.4%","11.2%","12.9%","13.8%","14.4%","9.3%","9.4%","11.1%","4.5%","40.0%"]},"columns":[{"accessor":"years_with_curr_manager","name":"years_with_curr_manager","type":"numeric"},{"accessor":"attrition","name":"attrition","type":"character"},{"accessor":"n","name":"n","type":"numeric"},{"accessor":"pct","name":"pct","type":"character"}],"defaultPageSize":10,"paginationType":"numbers","showPageInfo":true,"minRows":1,"highlight":true,"bordered":true,"striped":true,"compact":true,"nowrap":true,"dataKey":"c70681c477534fabeb079c36b5beb0a5","key":"c70681c477534fabeb079c36b5beb0a5"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">data <span style="color:#ff6ac1">&lt;-</span> data <span style="color:#ff6ac1">%&gt;%</span> 
  <span style="color:#57c7ff">mutate</span>(years_manager_score <span style="color:#ff6ac1">=</span> <span style="color:#57c7ff">ifelse</span>(years_with_curr_manager <span style="color:#ff6ac1">==</span> <span style="color:#ff9f43">0</span>, <span style="color:#ff9f43">1</span>, <span style="color:#ff9f43">0</span>))
</code></pre></div><div id="htmlwidget-16" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-16">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"years_manager_score":[0,1],"attrition":["Yes","Yes"],"n":[456,255],"pct":["12.6%","32.3%"]},"columns":[{"accessor":"years_manager_score","name":"years_manager_score","type":"numeric"},{"accessor":"attrition","name":"attrition","type":"character"},{"accessor":"n","name":"n","type":"numeric"},{"accessor":"pct","name":"pct","type":"character"}],"defaultPageSize":10,"paginationType":"numbers","showPageInfo":true,"minRows":1,"highlight":true,"bordered":true,"striped":true,"compact":true,"nowrap":true,"dataKey":"047c23f5761b4962cd5217b3620b1be9","key":"047c23f5761b4962cd5217b3620b1be9"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<h3 id="business-travel">Business Travel</h3>
<p>People who travel at all are more likely to leave than those who don’t travel, but people who travel frequently have a higher proportion of attrition.</p>
<div id="htmlwidget-17" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-17">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"business_travel":["Non-Travel","Travel Frequently","Travel Rarely"],"attrition":["Yes","Yes","Yes"],"n":[36,207,468],"pct":["8.0%","24.9%","15.0%"]},"columns":[{"accessor":"business_travel","name":"business_travel","type":"character"},{"accessor":"attrition","name":"attrition","type":"character"},{"accessor":"n","name":"n","type":"numeric"},{"accessor":"pct","name":"pct","type":"character"}],"defaultPageSize":10,"paginationType":"numbers","showPageInfo":true,"minRows":1,"highlight":true,"bordered":true,"striped":true,"compact":true,"nowrap":true,"dataKey":"1daa35b77d9de60d519fd10711f59d3e","key":"1daa35b77d9de60d519fd10711f59d3e"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">data <span style="color:#ff6ac1">&lt;-</span> data <span style="color:#ff6ac1">%&gt;%</span> 
  <span style="color:#57c7ff">mutate</span>(travel_score <span style="color:#ff6ac1">=</span> <span style="color:#57c7ff">ifelse</span>(business_travel <span style="color:#ff6ac1">==</span> <span style="color:#5af78e">&#34;Travel Frequently&#34;</span>, <span style="color:#ff9f43">2</span>, 
                               <span style="color:#57c7ff">ifelse</span>(business_travel <span style="color:#ff6ac1">==</span> <span style="color:#5af78e">&#34;Travel Rarely&#34;</span>, <span style="color:#ff9f43">1</span>, <span style="color:#ff9f43">0</span>)))
</code></pre></div><div id="htmlwidget-18" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-18">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"travel_score":[0,1,2],"attrition":["Yes","Yes","Yes"],"n":[36,468,207],"pct":["8.0%","15.0%","24.9%"]},"columns":[{"accessor":"travel_score","name":"travel_score","type":"numeric"},{"accessor":"attrition","name":"attrition","type":"character"},{"accessor":"n","name":"n","type":"numeric"},{"accessor":"pct","name":"pct","type":"character"}],"defaultPageSize":10,"paginationType":"numbers","showPageInfo":true,"minRows":1,"highlight":true,"bordered":true,"striped":true,"compact":true,"nowrap":true,"dataKey":"39ad65c13bf6857c375cdb6e7be734d1","key":"39ad65c13bf6857c375cdb6e7be734d1"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<h3 id="job-level">Job Level</h3>
<p>Job level wasn’t significant in the model and I can see why, there’s not much distinction between levels as far as attrition goes. Maybe I’ll just reverse code for job level 5.</p>
<div id="htmlwidget-19" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-19">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"job_level":[1,2,3,4,5],"attrition":["Yes","Yes","Yes","Yes","Yes"],"n":[252,285,96,51,27],"pct":["15.5%","17.8%","14.7%","16.0%","13.0%"]},"columns":[{"accessor":"job_level","name":"job_level","type":"numeric"},{"accessor":"attrition","name":"attrition","type":"character"},{"accessor":"n","name":"n","type":"numeric"},{"accessor":"pct","name":"pct","type":"character"}],"defaultPageSize":10,"paginationType":"numbers","showPageInfo":true,"minRows":1,"highlight":true,"bordered":true,"striped":true,"compact":true,"nowrap":true,"dataKey":"fccb8e7aa8ca37bc3d99d09fa2816b02","key":"fccb8e7aa8ca37bc3d99d09fa2816b02"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">data <span style="color:#ff6ac1">&lt;-</span> data <span style="color:#ff6ac1">%&gt;%</span> 
  <span style="color:#57c7ff">mutate</span>(job_level_score <span style="color:#ff6ac1">=</span> <span style="color:#57c7ff">ifelse</span>(job_level <span style="color:#ff6ac1">==</span> <span style="color:#ff9f43">5</span>, <span style="color:#ff9f43">-1</span>, <span style="color:#ff9f43">0</span>))
</code></pre></div><div id="htmlwidget-20" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-20">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"job_level_score":[-1,0],"attrition":["Yes","Yes"],"n":[27,684],"pct":["13.0%","16.3%"]},"columns":[{"accessor":"job_level_score","name":"job_level_score","type":"numeric"},{"accessor":"attrition","name":"attrition","type":"character"},{"accessor":"n","name":"n","type":"numeric"},{"accessor":"pct","name":"pct","type":"character"}],"defaultPageSize":10,"paginationType":"numbers","showPageInfo":true,"minRows":1,"highlight":true,"bordered":true,"striped":true,"compact":true,"nowrap":true,"dataKey":"6a6bd5fb9184299248c73e3ae0159488","key":"6a6bd5fb9184299248c73e3ae0159488"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<h3 id="education-field">Education Field</h3>
<p>Human resources are much more likely to leave than any other education field. This is the variable all the others in the model tested against, so it makes sense why all the other education fields looked like they were less likely to leave. What’s up with HR?</p>
<div id="htmlwidget-21" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-21">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"education_field":["Human Resources","Life Sciences","Marketing","Medical","Other","Technical Degree"],"attrition":["Yes","Yes","Yes","Yes","Yes","Yes"],"n":[33,303,75,225,30,45],"pct":["40.7%","16.7%","15.7%","16.2%","12.2%","11.4%"]},"columns":[{"accessor":"education_field","name":"education_field","type":"character"},{"accessor":"attrition","name":"attrition","type":"character"},{"accessor":"n","name":"n","type":"numeric"},{"accessor":"pct","name":"pct","type":"character"}],"defaultPageSize":10,"paginationType":"numbers","showPageInfo":true,"minRows":1,"highlight":true,"bordered":true,"striped":true,"compact":true,"nowrap":true,"dataKey":"34298f3003240d4d5a0a952d73681490","key":"34298f3003240d4d5a0a952d73681490"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">data <span style="color:#ff6ac1">&lt;-</span> data <span style="color:#ff6ac1">%&gt;%</span> 
  <span style="color:#57c7ff">mutate</span>(education_field_score <span style="color:#ff6ac1">=</span> <span style="color:#57c7ff">ifelse</span>(education_field <span style="color:#ff6ac1">==</span> <span style="color:#5af78e">&#34;Human Resources&#34;</span>, <span style="color:#ff9f43">2</span>, <span style="color:#ff9f43">0</span>))
</code></pre></div><div id="htmlwidget-22" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-22">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"education_field_score":[0,2],"attrition":["Yes","Yes"],"n":[678,33],"pct":["15.7%","40.7%"]},"columns":[{"accessor":"education_field_score","name":"education_field_score","type":"numeric"},{"accessor":"attrition","name":"attrition","type":"character"},{"accessor":"n","name":"n","type":"numeric"},{"accessor":"pct","name":"pct","type":"character"}],"defaultPageSize":10,"paginationType":"numbers","showPageInfo":true,"minRows":1,"highlight":true,"bordered":true,"striped":true,"compact":true,"nowrap":true,"dataKey":"91969cbf99dea1dcb4f039def5ce4f6b","key":"91969cbf99dea1dcb4f039def5ce4f6b"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<h3 id="training-times-last-year">Training Times Last Year</h3>
<p>It looks like maybe people who had a lot of training had lower attrition.</p>
<div id="htmlwidget-23" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-23">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"training_times_last_year":[0,1,2,3,4,5,6],"attrition":["Yes","Yes","Yes","Yes","Yes","Yes","Yes"],"n":[30,30,282,258,48,51,12],"pct":["18.5%","14.1%","17.2%","17.5%","13.0%","14.3%","6.2%"]},"columns":[{"accessor":"training_times_last_year","name":"training_times_last_year","type":"numeric"},{"accessor":"attrition","name":"attrition","type":"character"},{"accessor":"n","name":"n","type":"numeric"},{"accessor":"pct","name":"pct","type":"character"}],"defaultPageSize":10,"paginationType":"numbers","showPageInfo":true,"minRows":1,"highlight":true,"bordered":true,"striped":true,"compact":true,"nowrap":true,"dataKey":"6a449f4335a616e152c954e245a40fbe","key":"6a449f4335a616e152c954e245a40fbe"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">data <span style="color:#ff6ac1">&lt;-</span> data <span style="color:#ff6ac1">%&gt;%</span> 
  <span style="color:#57c7ff">mutate</span>(training_score <span style="color:#ff6ac1">=</span> <span style="color:#57c7ff">ifelse</span>(training_times_last_year <span style="color:#ff6ac1">&lt;</span> <span style="color:#ff9f43">4</span>, <span style="color:#ff9f43">1</span>, <span style="color:#ff9f43">0</span>))
</code></pre></div><div id="htmlwidget-24" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-24">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"training_score":[0,1],"attrition":["Yes","Yes"],"n":[111,600],"pct":["12.1%","17.2%"]},"columns":[{"accessor":"training_score","name":"training_score","type":"numeric"},{"accessor":"attrition","name":"attrition","type":"character"},{"accessor":"n","name":"n","type":"numeric"},{"accessor":"pct","name":"pct","type":"character"}],"defaultPageSize":10,"paginationType":"numbers","showPageInfo":true,"minRows":1,"highlight":true,"bordered":true,"striped":true,"compact":true,"nowrap":true,"dataKey":"87f37f1399037564ae7cdba1de3c5339","key":"87f37f1399037564ae7cdba1de3c5339"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<h3 id="job-satisfaction">Job Satisfaction</h3>
<p>Job satisfaction - 4 is very high, 1 is low.</p>
<div id="htmlwidget-25" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-25">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"job_satisfaction":[1,2,3,4,"NA"],"attrition":["Yes","Yes","Yes","Yes","Yes"],"n":[197,138,219,156,1],"pct":["22.9%","16.4%","16.6%","11.4%","5.0%"]},"columns":[{"accessor":"job_satisfaction","name":"job_satisfaction","type":"numeric"},{"accessor":"attrition","name":"attrition","type":"character"},{"accessor":"n","name":"n","type":"numeric"},{"accessor":"pct","name":"pct","type":"character"}],"defaultPageSize":10,"paginationType":"numbers","showPageInfo":true,"minRows":1,"highlight":true,"bordered":true,"striped":true,"compact":true,"nowrap":true,"dataKey":"51418b89419a429a3052b8486a505a9b","key":"51418b89419a429a3052b8486a505a9b"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">data <span style="color:#ff6ac1">&lt;-</span> data <span style="color:#ff6ac1">%&gt;%</span> 
  <span style="color:#57c7ff">mutate</span>(job_satisfaction_score <span style="color:#ff6ac1">=</span> <span style="color:#57c7ff">ifelse</span>(<span style="color:#57c7ff">is.na</span>(job_satisfaction) <span style="color:#ff6ac1">|</span> job_satisfaction <span style="color:#ff6ac1">==</span> <span style="color:#ff9f43">4</span>, <span style="color:#ff9f43">0</span>,
                                         <span style="color:#57c7ff">ifelse</span>(<span style="color:#57c7ff">between</span>(job_satisfaction, <span style="color:#ff9f43">2</span>,<span style="color:#ff9f43">3</span>), <span style="color:#ff9f43">1</span>, <span style="color:#ff9f43">2</span>))) 
</code></pre></div><div id="htmlwidget-26" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-26">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"job_satisfaction_score":[0,1,2],"attrition":["Yes","Yes","Yes"],"n":[157,357,197],"pct":["11.3%","16.5%","22.9%"]},"columns":[{"accessor":"job_satisfaction_score","name":"job_satisfaction_score","type":"numeric"},{"accessor":"attrition","name":"attrition","type":"character"},{"accessor":"n","name":"n","type":"numeric"},{"accessor":"pct","name":"pct","type":"character"}],"defaultPageSize":10,"paginationType":"numbers","showPageInfo":true,"minRows":1,"highlight":true,"bordered":true,"striped":true,"compact":true,"nowrap":true,"dataKey":"c7d7e0bfaa6166b4f7ac092d3e05c4f5","key":"c7d7e0bfaa6166b4f7ac092d3e05c4f5"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<h2 id="attrition-risk-score-and-level">Attrition Risk Score and Level</h2>
<p>Now add them all up to create a score and plot it. There are some people who have an attrition score of 0, by the way, but none of them left.</p>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">data <span style="color:#ff6ac1">&lt;-</span> data <span style="color:#ff6ac1">%&gt;%</span> 
  <span style="color:#57c7ff">select</span>(employee_id, <span style="color:#57c7ff">contains</span>(<span style="color:#5af78e">&#34;score&#34;</span>)) <span style="color:#ff6ac1">%&gt;%</span> 
  <span style="color:#57c7ff">mutate</span>(attrition_score <span style="color:#ff6ac1">=</span> <span style="color:#57c7ff">rowSums</span>(.)) <span style="color:#ff6ac1">%&gt;%</span> 
  <span style="color:#57c7ff">mutate</span>(attrition_score <span style="color:#ff6ac1">=</span> attrition_score <span style="color:#ff6ac1">-</span>employee_id) <span style="color:#ff6ac1">%&gt;%</span> 
  <span style="color:#57c7ff">left_join</span>(data)

p1 <span style="color:#ff6ac1">&lt;-</span> <span style="color:#57c7ff">count</span>(data, attrition_score, attrition) <span style="color:#ff6ac1">%&gt;%</span> 
  <span style="color:#57c7ff">group_by</span>(attrition_score) <span style="color:#ff6ac1">%&gt;%</span> 
  <span style="color:#57c7ff">mutate</span>(pct <span style="color:#ff6ac1">=</span> n<span style="color:#ff6ac1">/</span><span style="color:#57c7ff">sum</span>(n)) <span style="color:#ff6ac1">%&gt;%</span> 
  <span style="color:#57c7ff">filter</span>(attrition <span style="color:#ff6ac1">==</span> <span style="color:#5af78e">&#34;Yes&#34;</span>) <span style="color:#ff6ac1">%&gt;%</span> 
  <span style="color:#57c7ff">ggplot</span>(<span style="color:#57c7ff">aes</span>(x <span style="color:#ff6ac1">=</span> attrition_score, y <span style="color:#ff6ac1">=</span> pct))<span style="color:#ff6ac1">+</span>
  <span style="color:#57c7ff">scale_y_continuous</span>(name <span style="color:#ff6ac1">=</span> <span style="color:#5af78e">&#34;Percent Attrition&#34;</span>, labels <span style="color:#ff6ac1">=</span> scales<span style="color:#ff6ac1">::</span>percent)<span style="color:#ff6ac1">+</span>
  <span style="color:#57c7ff">scale_x_continuous</span>(name <span style="color:#ff6ac1">=</span> <span style="color:#5af78e">&#34;Attrition Score&#34;</span>, breaks <span style="color:#ff6ac1">=</span> <span style="color:#57c7ff">seq</span>(<span style="color:#ff9f43">1</span>,<span style="color:#ff9f43">11</span>,<span style="color:#ff9f43">1</span>))<span style="color:#ff6ac1">+</span>
  <span style="color:#57c7ff">geom_line</span>(color <span style="color:#ff6ac1">=</span> pal.9[6], size <span style="color:#ff6ac1">=</span> <span style="color:#ff9f43">1.2</span>)<span style="color:#ff6ac1">+</span>
  my_theme
</code></pre></div><p>I can also make a risk level based on the scores.</p>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">data <span style="color:#ff6ac1">&lt;-</span> data <span style="color:#ff6ac1">%&gt;%</span>
  <span style="color:#57c7ff">mutate</span>(attrition_level <span style="color:#ff6ac1">=</span> <span style="color:#57c7ff">factor</span>(
    <span style="color:#57c7ff">ifelse</span>(
      <span style="color:#57c7ff">between</span>(attrition_score, <span style="color:#ff9f43">0</span>, <span style="color:#ff9f43">3</span>),
      <span style="color:#5af78e">&#34;Low&#34;</span>,
      <span style="color:#57c7ff">ifelse</span>(<span style="color:#57c7ff">between</span>(attrition_score, <span style="color:#ff9f43">4</span>, <span style="color:#ff9f43">6</span>), <span style="color:#5af78e">&#34;Medium&#34;</span>, <span style="color:#5af78e">&#34;High&#34;</span>)
    ),
    levels <span style="color:#ff6ac1">=</span> <span style="color:#57c7ff">c</span>(<span style="color:#5af78e">&#34;Low&#34;</span>, <span style="color:#5af78e">&#34;Medium&#34;</span>, <span style="color:#5af78e">&#34;High&#34;</span>)
  ))


p2 <span style="color:#ff6ac1">&lt;-</span> data <span style="color:#ff6ac1">%&gt;%</span> 
  <span style="color:#57c7ff">count</span>(attrition_level, attrition) <span style="color:#ff6ac1">%&gt;%</span> 
  <span style="color:#57c7ff">group_by</span>(attrition_level) <span style="color:#ff6ac1">%&gt;%</span> 
  <span style="color:#57c7ff">mutate</span>(pct <span style="color:#ff6ac1">=</span> n<span style="color:#ff6ac1">/</span><span style="color:#57c7ff">sum</span>(n)) <span style="color:#ff6ac1">%&gt;%</span> 
  <span style="color:#57c7ff">filter</span>(attrition <span style="color:#ff6ac1">==</span> <span style="color:#5af78e">&#34;Yes&#34;</span>) <span style="color:#ff6ac1">%&gt;%</span> 
  <span style="color:#57c7ff">ggplot</span>(<span style="color:#57c7ff">aes</span>(x <span style="color:#ff6ac1">=</span> attrition_level, y <span style="color:#ff6ac1">=</span> pct, fill <span style="color:#ff6ac1">=</span> attrition_level))<span style="color:#ff6ac1">+</span>
  <span style="color:#57c7ff">geom_col</span>()<span style="color:#ff6ac1">+</span>
  <span style="color:#57c7ff">geom_text</span>(<span style="color:#57c7ff">aes</span>(x <span style="color:#ff6ac1">=</span> attrition_level, y <span style="color:#ff6ac1">=</span> pct, label <span style="color:#ff6ac1">=</span> scales<span style="color:#ff6ac1">::</span><span style="color:#57c7ff">percent</span>(pct), group <span style="color:#ff6ac1">=</span> attrition_level),
                  position <span style="color:#ff6ac1">=</span> <span style="color:#57c7ff">position_stack</span>(vjust <span style="color:#ff6ac1">=</span> <span style="color:#ff9f43">.5</span>), color <span style="color:#ff6ac1">=</span> <span style="color:#5af78e">&#34;white&#34;</span>, size <span style="color:#ff6ac1">=</span> <span style="color:#ff9f43">5</span>)<span style="color:#ff6ac1">+</span>
  <span style="color:#57c7ff">scale_fill_manual</span>(values <span style="color:#ff6ac1">=</span> <span style="color:#57c7ff">c</span>(pal.9[7], pal.9[8], pal.9[9]))<span style="color:#ff6ac1">+</span>
  <span style="color:#57c7ff">labs</span>(x <span style="color:#ff6ac1">=</span> <span style="color:#5af78e">&#34;Attrition Level&#34;</span>)<span style="color:#ff6ac1">+</span>
  my_theme<span style="color:#ff6ac1">+</span>
  <span style="color:#57c7ff">theme</span>(axis.text.y <span style="color:#ff6ac1">=</span> <span style="color:#57c7ff">element_blank</span>(),
        axis.title.y <span style="color:#ff6ac1">=</span> <span style="color:#57c7ff">element_blank</span>(),
        axis.ticks.y <span style="color:#ff6ac1">=</span> <span style="color:#57c7ff">element_blank</span>())
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">ggpubr<span style="color:#ff6ac1">::</span><span style="color:#57c7ff">ggarrange</span>(p1, p2, align <span style="color:#ff6ac1">=</span> <span style="color:#5af78e">&#39;hv&#39;</span>)
</code></pre></div><p><img src="https://kpress.dev/post/2021-06-21-the-office-part-i/index.en-us_files/figure-html/unnamed-chunk-64-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Next time maybe I’ll do some latent profile analysis on this dataset.</p>
              
            </div>
          </div>
          <div id="post-footer" class="post-footer main-content-wrap">
            
              
                
                
                  <div class="post-footer-tags">
                    <span class="text-color-light text-small">TAGGED IN</span><br/>
                    
  <a class="tag tag--primary tag--small" href="https://kpress.dev/tags/datasets/">Datasets</a>

  <a class="tag tag--primary tag--small" href="https://kpress.dev/tags/modeling/">Modeling</a>

  <a class="tag tag--primary tag--small" href="https://kpress.dev/tags/the-office/">The Office</a>

                  </div>
                
              
            
            <div class="post-actions-wrap">
  
      <nav >
        <ul class="post-actions post-action-nav">
          
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="https://kpress.dev/blog/2021-07-12-the-office-part-ii-the-smartest-guys-in-the-room/" data-tooltip="The Office Part II: The Smartest Guys In The Room">
              
                  <i class="fa fa-angle-left"></i>
                  <span class="hide-xs hide-sm text-small icon-ml">NEXT</span>
                </a>
            </li>
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="https://kpress.dev/blog/2021-01-03-fight-the-future/" data-tooltip="Fight The Future">
              
                  <span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
                  <i class="fa fa-angle-right"></i>
                </a>
            </li>
          
        </ul>
      </nav>
    <ul class="post-actions post-action-share" >
      
        <li class="post-action hide-lg hide-md hide-sm">
          <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions">
            <i class="fa fa-share-alt"></i>
          </a>
        </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=https://kpress.dev/blog/2021-06-22-the-office-part-i/">
              <i class="fa fa-twitter"></i>
            </a>
          </li>
        
      
      
        <li class="post-action">
          <a class="post-action-btn btn btn--default" href="#disqus_thread">
            <i class="fa fa-comment-o"></i>
          </a>
        </li>
      
      <li class="post-action">
        
          <a class="post-action-btn btn btn--default" href="#">
        
          <i class="fa fa-list"></i>
        </a>
      </li>
    </ul>
  
</div>

            
              
                <div id="disqus_thread">
  <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
              
            
          </div>
        </article>
        <footer id="footer" class="main-content-wrap">
  <span class="copyrights">
    &copy; 2021 Katie Press. All Rights Reserved
  </span>
</footer>

      </div>
      <div id="bottom-bar" class="post-bottom-bar" data-behavior="5">
        <div class="post-actions-wrap">
  
      <nav >
        <ul class="post-actions post-action-nav">
          
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="https://kpress.dev/blog/2021-07-12-the-office-part-ii-the-smartest-guys-in-the-room/" data-tooltip="The Office Part II: The Smartest Guys In The Room">
              
                  <i class="fa fa-angle-left"></i>
                  <span class="hide-xs hide-sm text-small icon-ml">NEXT</span>
                </a>
            </li>
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="https://kpress.dev/blog/2021-01-03-fight-the-future/" data-tooltip="Fight The Future">
              
                  <span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
                  <i class="fa fa-angle-right"></i>
                </a>
            </li>
          
        </ul>
      </nav>
    <ul class="post-actions post-action-share" >
      
        <li class="post-action hide-lg hide-md hide-sm">
          <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions">
            <i class="fa fa-share-alt"></i>
          </a>
        </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=https://kpress.dev/blog/2021-06-22-the-office-part-i/">
              <i class="fa fa-twitter"></i>
            </a>
          </li>
        
      
      
        <li class="post-action">
          <a class="post-action-btn btn btn--default" href="#disqus_thread">
            <i class="fa fa-comment-o"></i>
          </a>
        </li>
      
      <li class="post-action">
        
          <a class="post-action-btn btn btn--default" href="#">
        
          <i class="fa fa-list"></i>
        </a>
      </li>
    </ul>
  
</div>

      </div>
      <div id="share-options-bar" class="share-options-bar" data-behavior="5">
  <i id="btn-close-shareoptions" class="fa fa-close"></i>
  <ul class="share-options">
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://twitter.com/intent/tweet?text=https%3A%2F%2Fkpress.dev%2Fblog%2F2021-06-22-the-office-part-i%2F">
          <i class="fa fa-twitter"></i><span>Share on Twitter</span>
        </a>
      </li>
    
  </ul>
</div>
<div id="share-options-mask" class="share-options-mask"></div>
    </div>
    
    <div id="about">
  <div id="about-card">
    <div id="about-btn-close">
      <i class="fa fa-remove"></i>
    </div>
    
      <img id="about-card-picture" src="https://kpress.dev/img/tuxedo.jpg" alt="Author&#39;s picture" />
    
    <h4 id="about-card-name">Katie Press</h4>
    
      <div id="about-card-bio">R Programmer, Data Enthusiast</div>
    
    
      <div id="about-card-job">
        <i class="fa fa-briefcase"></i>
        <br/>
        Researcher
      </div>
    
    
      <div id="about-card-location">
        <i class="fa fa-map-marker"></i>
        <br/>
        USA
      </div>
    
  </div>
</div>

    

    
  
    
      <div id="cover" style="background-image:url('https://kpress.dev/images/space3.jpg');"></div>
    
  


    
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js" integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js" integrity="sha256-/BfiIkHlHoVihZdc6TFuj7MmJ0TWcWsMXkeDFwhi0zw=" crossorigin="anonymous"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.7/js/jquery.fancybox.min.js" integrity="sha256-GEAnjcTqVP+vBp3SSc8bEDQqvWAZMiHyUSIorrWwH50=" crossorigin="anonymous"></script>


<script src="https://kpress.dev/js/script-pcw6v3xilnxydl1vddzazdverrnn9ctynvnxgwho987mfyqkuylcb1nlt.min.js"></script>


  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages.r.min.js"></script>
  

<script lang="javascript">
window.onload = updateMinWidth;
window.onresize = updateMinWidth;
document.getElementById("sidebar").addEventListener("transitionend", updateMinWidth);
function updateMinWidth() {
  var sidebar = document.getElementById("sidebar");
  var main = document.getElementById("main");
  main.style.minWidth = "";
  var w1 = getComputedStyle(main).getPropertyValue("min-width");
  var w2 = getComputedStyle(sidebar).getPropertyValue("width");
  var w3 = getComputedStyle(sidebar).getPropertyValue("left");
  main.style.minWidth = `calc(${w1} - ${w2} - ${w3})`;
}
</script>

<script>
$(document).ready(function() {
  hljs.configure({ classPrefix: '', useBR: false });
  $('pre.code-highlight > code, pre > code').each(function(i, block) {
    if (!$(this).hasClass('codeblock')) {
      $(this).addClass('codeblock');
    }
    hljs.highlightBlock(block);
  });
});
</script>


  
    
      <script>
        var disqus_config = function () {
          this.page.url = 'https:\/\/kpress.dev\/blog\/2021-06-22-the-office-part-i\/';
          
            this.page.identifier = '\/blog\/2021-06-22-the-office-part-i\/'
          
        };
        (function() {
          
          
          if (window.location.hostname == "localhost") {
            return;
          }
          var d = document, s = d.createElement('script');
          var disqus_shortname = 'blog-zxbl2vcnni';
          s.src = '//' + disqus_shortname + '.disqus.com/embed.js';

          s.setAttribute('data-timestamp', +new Date());
          (d.head || d.body).appendChild(s);
        })();
      </script>
    
  




    
  </body>
</html>

